type: trigger
#debug: true
name: openappsec/openappsec-url-instead-of-file
description: "Detect openappsec 'prevent' securityActions on 'URL instead of file' events (when waf blocks malicious request)"
filter: evt.Meta.log_type == 'openappsec_security_log' and Lower(evt.Meta.security_action) == 'prevent' and Lower(evt.Meta.incident_type) contains 'url instead of file'
groupby: evt.Meta.source_ip
blackhole: 5m
labels:
 service: openappsec
 type: exploit
 remediation: true