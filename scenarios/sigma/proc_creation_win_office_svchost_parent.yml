type: trigger
name: sigma/proc_creation_win_office_svchost_parent
description: |
  Detects an svchost process spawning an instance of an office application. This happens when the initial word application creates an instance of one of the Office COM objects such as 'Word.Application', 'Excel.Application', etc.
  This can be used by malicious actors to create malicious Office documents with macros on the fly. (See vba2clr project in the references)
  
filter: |
  (evt.Meta.service == 'sysmon' && evt.Parsed.EventID == '1') && (evt.Parsed.ParentImage endsWith '\\svchost.exe' && (evt.Parsed.Image endsWith '\\winword.exe' || evt.Parsed.Image endsWith '\\excel.exe' || evt.Parsed.Image endsWith '\\powerpnt.exe' || evt.Parsed.Image endsWith '\\msaccess.exe' || evt.Parsed.Image endsWith '\\mspub.exe' || evt.Parsed.Image endsWith '\\eqnedt32.exe' || evt.Parsed.Image endsWith '\\visio.exe'))
blackhole: 2m
#status: experimental
labels:
  service: windows
  confidence: 0
  spoofable: 0
#  classification:

  label: "Suspicious New Instance Of An Office COM Object"
  behavior : "windows:audit"
  remediation: false

scope:
  type: ParentProcessId
  expression: evt.Parsed.ParentProcessId

