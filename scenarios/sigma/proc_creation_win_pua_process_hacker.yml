type: trigger
name: sigma/proc_creation_win_pua_process_hacker
description: |
  Detects the execution of Process Hacker based on binary metadata information (Image, Hash, Imphash, etc). Process Hacker is a tool to view and manipulate processes, kernel options and other low level options. Threat actors regularly abuse it to manipulate system processes.
filter: |
  (evt.Meta.service == 'sysmon' && evt.Parsed.EventID == '1') && (evt.Parsed.Image contains '\\ProcessHacker_' || evt.Parsed.Image endsWith '\\ProcessHacker.exe' || evt.Parsed.OriginalFileName == 'ProcessHacker.exe' || evt.Parsed.OriginalFileName == 'Process Hacker' || evt.Parsed.Description == 'Process Hacker' || evt.Parsed.Product == 'Process Hacker' || evt.Parsed.Hashes contains 'MD5=68F9B52895F4D34E74112F3129B3B00D' || evt.Parsed.Hashes contains 'MD5=B365AF317AE730A67C936F21432B9C71' || evt.Parsed.Hashes contains 'SHA1=A0BDFAC3CE1880B32FF9B696458327CE352E3B1D' || evt.Parsed.Hashes contains 'SHA1=C5E2018BF7C0F314FED4FD7FE7E69FA2E648359E' || evt.Parsed.Hashes contains 'SHA256=D4A0FE56316A2C45B9BA9AC1005363309A3EDC7ACF9E4DF64D326A0FF273E80F' || evt.Parsed.Hashes contains 'SHA256=BD2C2CF0631D881ED382817AFCCE2B093F4E412FFB170A719E2762F250ABFEA4' || evt.Parsed.Hashes contains 'IMPHASH=3695333C60DEDECDCAFF1590409AA462' || evt.Parsed.Hashes contains 'IMPHASH=04DE0AD9C37EB7BD52043D2ECAC958DF' || evt.Parsed.md5 == '68f9b52895f4d34e74112f3129b3b00d' || evt.Parsed.md5 == 'b365af317ae730a67c936f21432b9c71' || evt.Parsed.sha1 == 'c5e2018bf7c0f314fed4fd7fe7e69fa2e648359e' || evt.Parsed.sha1 == 'a0bdfac3ce1880b32ff9b696458327ce352e3b1d' || evt.Parsed.sha256 == 'd4a0fe56316a2c45b9ba9ac1005363309a3edc7acf9e4df64d326a0ff273e80f' || evt.Parsed.sha256 == 'bd2c2cf0631d881ed382817afcce2b093f4e412ffb170a719e2762f250abfea4' || evt.Parsed.Imphash == '04de0ad9c37eb7bd52043d2ecac958df' || evt.Parsed.Imphash == '3695333c60dedecdcaff1590409aa462')
blackhole: 2m
#status: experimental
labels:
  service: windows
  confidence: 0
  spoofable: 0
#  classification:

  label: "PUA - Process Hacker Execution"
  behavior : "windows:audit"
  remediation: false

scope:
  type: ParentProcessId
  expression: evt.Parsed.ParentProcessId

