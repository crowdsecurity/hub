type: trigger
name: sigma/web_sonicwall_jarrewrite_exploit
description: |
  Detects exploitation attempts of the SonicWall Jarrewrite Exploit
filter: |
  evt.Meta.service == 'http' && (evt.Parsed.http_args contains "/cgi-bin/jarrewrite.sh" && (evt.Meta.http_user_agent contains ":;" || evt.Meta.http_user_agent contains "() {" || evt.Meta.http_user_agent contains "/bin/bash -c"))
blackhole: 2m
labels:
  type: exploit
  remediation: true
