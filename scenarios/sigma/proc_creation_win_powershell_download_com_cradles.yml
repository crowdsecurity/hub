type: trigger
name: sigma/proc_creation_win_powershell_download_com_cradles
description: |
  Detects usage of COM objects that can be abused to download files in PowerShell by CLSID
filter: |
  (evt.Meta.service == 'sysmon' && evt.Parsed.EventID == '1') && (evt.Parsed.CommandLine contains '[Type]::GetTypeFromCLSID(' && (evt.Parsed.CommandLine contains '0002DF01-0000-0000-C000-000000000046' || evt.Parsed.CommandLine contains 'F6D90F16-9C73-11D3-B32E-00C04F990BB4' || evt.Parsed.CommandLine contains 'F5078F35-C551-11D3-89B9-0000F81FE221' || evt.Parsed.CommandLine contains '88d96a0a-f192-11d4-a65f-0040963251e5' || evt.Parsed.CommandLine contains 'AFBA6B42-5692-48EA-8141-DC517DCF0EF1' || evt.Parsed.CommandLine contains 'AFB40FFD-B609-40A3-9828-F88BBE11E4E3' || evt.Parsed.CommandLine contains '88d96a0b-f192-11d4-a65f-0040963251e5' || evt.Parsed.CommandLine contains '2087c2f4-2cef-4953-a8ab-66779b670495' || evt.Parsed.CommandLine contains '000209FF-0000-0000-C000-000000000046' || evt.Parsed.CommandLine contains '00024500-0000-0000-C000-000000000046'))
blackhole: 2m
#status: experimental
labels:
  service: windows
  confidence: 0
  spoofable: 0
#  classification:

  label: "Potential COM Objects Download Cradles Usage - Process Creation"
  behavior : "windows:audit"
  remediation: false

scope:
  type: ParentProcessId
  expression: evt.Parsed.ParentProcessId

