type: trigger
name: sigma/web_cve_2010_5278_exploitation_attempt
description: |
  MODx manager - Local File Inclusion:Directory traversal vulnerability in manager/controllers/default/resource/tvs.php in MODx Revolution 2.0.2-pl, and possibly earlier,
  when magic_quotes_gpc is disabled, allows remote attackers to read arbitrary files via a .. (dot dot) in the class_key parameter.
  
filter: |
  evt.Meta.service == 'http' && (Match("*/manager/controllers/default/resource/tvs.php?class_key=../../../../../../../../../../windows/win.ini%00*", evt.Parsed.http_args))
blackhole: 2m
labels:
  type: exploit
  remediation: true
