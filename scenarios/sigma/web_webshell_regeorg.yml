type: trigger
name: sigma/web_webshell_regeorg
description: |
  Certain strings in the uri_query field when combined with null referer and null user agent can indicate activity associated with the webshell ReGeorg.
filter: |
  evt.Meta.service == 'http' && ((evt.Parsed.http_args contains "cmd=read" || evt.Parsed.http_args contains "connect&target" || evt.Parsed.http_args contains "cmd=connect" || evt.Parsed.http_args contains "cmd=disconnect" || evt.Parsed.http_args contains "cmd=forward") && (evt.Parsed.http_referer == '' && evt.Meta.http_user_agent == '' && evt.Meta.http_verb == "POST"))
blackhole: 2m
labels:
  type: exploit
  remediation: true
