type: trigger
name: sigma/proc_creation_win_susp_hiding_malware_in_fonts_folder
description: |
  Monitors for the hiding possible malicious files in the C:\Windows\Fonts\ location. This folder doesn't require admin privillege to be written and executed from.
filter: |
  (evt.Meta.service == 'sysmon' && evt.Parsed.EventID == '1') && ((evt.Parsed.CommandLine contains 'echo' || evt.Parsed.CommandLine contains 'copy' || evt.Parsed.CommandLine contains 'type' || evt.Parsed.CommandLine contains 'file createnew' || evt.Parsed.CommandLine contains 'cacls') && evt.Parsed.CommandLine contains 'C:\\Windows\\Fonts\\' && (evt.Parsed.CommandLine contains '.sh' || evt.Parsed.CommandLine contains '.exe' || evt.Parsed.CommandLine contains '.dll' || evt.Parsed.CommandLine contains '.bin' || evt.Parsed.CommandLine contains '.bat' || evt.Parsed.CommandLine contains '.cmd' || evt.Parsed.CommandLine contains '.js' || evt.Parsed.CommandLine contains '.msh' || evt.Parsed.CommandLine contains '.reg' || evt.Parsed.CommandLine contains '.scr' || evt.Parsed.CommandLine contains '.ps' || evt.Parsed.CommandLine contains '.vb' || evt.Parsed.CommandLine contains '.jar' || evt.Parsed.CommandLine contains '.pl' || evt.Parsed.CommandLine contains '.inf' || evt.Parsed.CommandLine contains '.cpl' || evt.Parsed.CommandLine contains '.hta' || evt.Parsed.CommandLine contains '.msi' || evt.Parsed.CommandLine contains '.vbs'))
blackhole: 2m
#status: test
labels:
  service: windows
  confidence: 1
  spoofable: 0
#  classification:
#  - attack.t1211
#  - attack.t1059

  label: "Writing Of Malicious Files To The Fonts Folder"
  behavior : "windows:audit"
  remediation: false

scope:
  type: ParentProcessId
  expression: evt.Parsed.ParentProcessId

