type: trigger
name: sigma/web_jndi_exploit
description: |
  Detects exploitation attempt using the JDNIExploiit Kit
filter: |
  evt.Meta.service == 'http' && (evt.Line.Raw contains "/Basic/Command/Base64/" || evt.Line.Raw contains "/Basic/ReverseShell/" || evt.Line.Raw contains "/Basic/TomcatMemshell" || evt.Line.Raw contains "/Basic/JettyMemshell" || evt.Line.Raw contains "/Basic/WeblogicMemshell" || evt.Line.Raw contains "/Basic/JBossMemshell" || evt.Line.Raw contains "/Basic/WebsphereMemshell" || evt.Line.Raw contains "/Basic/SpringMemshell" || evt.Line.Raw contains "/Deserialization/URLDNS/" || evt.Line.Raw contains "/Deserialization/CommonsCollections1/Dnslog/" || evt.Line.Raw contains "/Deserialization/CommonsCollections2/Command/Base64/" || evt.Line.Raw contains "/Deserialization/CommonsBeanutils1/ReverseShell/" || evt.Line.Raw contains "/Deserialization/Jre8u20/TomcatMemshell" || evt.Line.Raw contains "/TomcatBypass/Dnslog/" || evt.Line.Raw contains "/TomcatBypass/Command/" || evt.Line.Raw contains "/TomcatBypass/ReverseShell/" || evt.Line.Raw contains "/TomcatBypass/TomcatMemshell" || evt.Line.Raw contains "/TomcatBypass/SpringMemshell" || evt.Line.Raw contains "/GroovyBypass/Command/" || evt.Line.Raw contains "/WebsphereBypass/Upload/")
blackhole: 2m
labels:
  type: exploit
  remediation: true
