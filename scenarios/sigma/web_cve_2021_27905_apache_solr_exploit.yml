type: trigger
name: sigma/web_cve_2021_27905_apache_solr_exploit
description: |
  Detects exploitation attempt of the CVE-2021-27905 which affects all Apache Solr versions prior to and including 8.8.1.
filter: |
  evt.Meta.service == 'http' && (((evt.Parsed.http_args contains "/solr/" && Match("*/debug/dump?*", evt.Parsed.http_args) && evt.Parsed.http_args contains "param=ContentStream") && int(evt.Meta.http_status) == 200) || (evt.Meta.http_verb == "GET" && (evt.Parsed.http_args contains "/solr/" && evt.Parsed.http_args contains "command=fetchindex" && evt.Parsed.http_args contains "masterUrl=") && int(evt.Meta.http_status) == 200))
blackhole: 2m
labels:
  type: exploit
  remediation: true
