type: trigger
name: sigma/proc_creation_win_susp_lsass_dump
description: |
  Detect creation of dump files containing the memory space of lsass.exe, which contains sensitive credentials.
  Identifies usage of Sysinternals procdump.exe to export the memory space of lsass.exe which contains sensitive credentials.
  
filter: |
  (evt.Meta.service == 'sysmon' && evt.Parsed.EventID == '1') && (evt.Parsed.CommandLine contains 'lsass' && evt.Parsed.CommandLine contains '.dmp' && not (evt.Parsed.Image endsWith '\\werfault.exe'))
blackhole: 2m
#status: test
labels:
  service: windows
  confidence: 1
  spoofable: 0
#  classification:
#  - attack.t1003.001

  label: "LSASS Memory Dumping"
  behavior : "windows:audit"
  remediation: false

scope:
  type: ParentProcessId
  expression: evt.Parsed.ParentProcessId

