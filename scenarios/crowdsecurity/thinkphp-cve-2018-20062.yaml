type: trigger
format: 2.0
#debug: true
name: crowdsecurity/thinkphp-cve-2018-20062
description: "Detect ThinkPHP CVE-2018-20062 exploitation attemps"
filter: |
  evt.Meta.log_type in ["http_access-log", "http_error-log"] and RegexpInFile(Lower(evt.Meta.http_path), "thinkphp_cve_2018-20062.txt")
data:
  - source_url: https://hub-data.crowdsec.net/web/thinkphp_cve_2018-20062.txt
    dest_file: thinkphp_cve_2018-20062.txt
    type: regexp
    strategy: LRU
    size: 20
    ttl: 10s
groupby: "evt.Meta.source_ip"
blackhole: 2m
labels:
  confidence: 3
  spoofable: 0
  classification:
    - attack.T1190
    - attack.T1595
    - cve.CVE-2018-20062
  behavior: "http:exploit"
  label: "ThinkPHP CVE-2018-20062"
  remediation: true
  service: thinkphp
