# for max (1) priority : kill on sight
type: trigger
name: crowdsecurity/suricata-major-severity
description: "Detect exploit attempts via emerging threat rules"
filter: "evt.Meta.log_type == 'suricata_alert' && evt.Parsed.proto == 'TCP' && evt.Meta.suricata_rule_severity == '1'"
groupby: evt.Meta.source_ip
blackhole: 1m
reprocess: true
labels:
 service: suricata
 type: exploit
 remediation: true
---
# for lower (2-3) priorities : wait for >=3 different signatures being triggered
type: leaky
capacity: 2
leakspeed: 20s
distinct: evt.Meta.suricata_alert_signature_id
name: crowdsecurity/suricata-high-medium-severity
description: "Detect exploit attempts via emerging threat rules"
filter: "evt.Meta.log_type == 'suricata_alert' && evt.Parsed.proto == 'TCP' && evt.Meta.suricata_rule_severity in ['2', '3']"
groupby: evt.Meta.source_ip
blackhole: 1m
reprocess: true
labels:
 service: suricata
 type: exploit
---
# and finally our catch-all :)
type: leaky
capacity: 9
leakspeed: 20s
distinct: evt.Parsed.suricata_alert_signature_id
name: crowdsecurity/suricata-generic
description: "Detect exploit attempts via emerging threat rules"
filter: "evt.Meta.log_type == 'suricata_alert'"
groupby: evt.Meta.source_ip
blackhole: 1m
reprocess: true
labels:
 service: suricata
 type: exploit
