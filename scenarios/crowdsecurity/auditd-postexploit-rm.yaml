type: leaky
debug: true
name: crowdsecurity/auditd-postexploit-rm
description: "Detect post-exploitation behaviour : rm execve bursts"
#we're looking for the EXCVE syscalls to 'rm'
#Q: 59 is execve on x86_64. How to make it portable ?
filter: evt.Meta.log_type == 'auditd_execve' && evt.Parsed.exe == '/usr/bin/rm'
#grouping by ppid to track on process doing a lot of invocations to rm, such as a shell script
groupby: evt.Parsed.ppid
leakspeed: 1s
capacity: 5
blackhole: 1m
labels:
  service: linux
  type: post-exploitation
  remediation: false
scope:
  type: pid
  expression: evt.Parsed.ppid