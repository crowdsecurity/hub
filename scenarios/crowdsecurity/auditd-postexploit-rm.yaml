type: leaky
#debug: true
name: crowdsecurity/auditd-postexploit-rm
description: "Detect post-exploitation behaviour : rm execve bursts"
filter: evt.Meta.log_type == 'auditd_execve' && evt.Unmarshaled.auditd.exe in ['/usr/bin/rm', '/bin/rm']
#grouping by ppid to track on process doing a lot of invocations to rm, such as a shell script
groupby: evt.Unmarshaled.auditd.ppid
leakspeed: 1s
capacity: 5
blackhole: 1m
labels:
  service: linux
  type: post-exploitation
  remediation: false
scope:
  type: pid
  expression: evt.Unmarshaled.auditd.ppid
