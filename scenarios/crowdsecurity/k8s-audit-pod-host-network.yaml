type: trigger
name: crowdsecurity/k8s-audit-pod-host-network
description: "Detect pods started with host networking"
filter: |
  evt.Meta.log_type == 'k8s-audit' &&
  evt.Unmarshaled.Verb == 'create' &&
  evt.Unmarshaled.ObjectRef?.Resource == 'pods' &&
  evt.Unmarshaled.RequestObject?.spec?.hostNetwork == true
labels:
 service: k8s
 type: pod-host-networking
 notification: true