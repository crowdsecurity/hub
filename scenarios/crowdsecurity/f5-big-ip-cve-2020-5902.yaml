type: trigger
format: 2.0
name: crowdsecurity/f5-big-ip-cve-2020-5902
description: "Detect cve-2020-5902 exploitation attemps"
filter: |
  evt.Meta.log_type in ["http_access-log", "http_error-log"] and 
    (
    Upper(evt.Meta.http_path) matches Upper('/tmui/login.jsp/..;/tmui/[^.]+.jsp\\?(fileName|command|directoryPath|tabId)=')
    or
    Upper(evt.Meta.http_path) matches Upper('/tmui/login.jsp/%2E%2E;/tmui/[^.]+.jsp\\?(fileName|command|directoryPath|tabId)=')
    )
groupby: "evt.Meta.source_ip"
blackhole: 2m
labels:
  type: http:exploit
  label: F5 BIG-IP CVE-2020-5902
  remediation: true
