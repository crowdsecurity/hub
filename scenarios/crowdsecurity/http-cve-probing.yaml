type: trigger
name: crowdsecurity/http-cve-probing
description: "Detect generic HTTP cve probing"
filter: |
  evt.Meta.service == 'http' and 
  evt.Meta.log_type in ['http_access-log', 'http_error-log'] and 
  evt.Meta.http_status in ['404', '403'] and
  any(File("trendy_cves_uris.json"), { 
    evt.Meta.http_path contains JsonExtract(#, "uri") ? evt.SetMeta("cve", JsonExtract(#, "cve")) : false 
  })
groupby: evt.Meta.source_ip
distinct: "evt.Meta.http_path"
data:
  # 
  - source_url: https://raw.githubusercontent.com/crowdsecurity/sec-lists/72227c393390cf2d9fe257089f17401a0a59ceb7/web/trendy_cves_uris.json
    dest_file: trendy_cves_uris.json
    type: string
blackhole: 1m
labels:
  confidence: 3
  spoofable: 0
  classification:
    - attack.T1595
  behavior: "http:scan"
  label: "HTTP CVE Probing"
  service: http
  remediation: true
