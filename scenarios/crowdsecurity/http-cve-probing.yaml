type: leaky
#debug: true
name: crowdsecurity/http-cve-probing
description: "Detect generic HTTP cve probing"
filter: |
  evt.Meta.service == 'http' and 
  evt.Meta.log_type in ['http_access-log', 'http_error-log'] and 
  evt.Meta.http_status in ['404', '403'] and
  any(File("trendy_cves.txt"), { Lower(evt.Meta.http_path) contains #})
groupby: evt.Meta.source_ip
distinct: "evt.Meta.http_path"
data:
  - source_url: https://hub-data.crowdsec.net/web/trendy_cves.txt
    dest_file: trendy_cves.txt
    type: string
capacity: 1
leakspeed: "10s"
blackhole: 1m
labels:
  confidence: 3
  spoofable: 0
  classification:
    - attack.T1595
  behavior: "http:scan"
  label: "HTTP CVE Probing"
  service: http
  remediation: true
