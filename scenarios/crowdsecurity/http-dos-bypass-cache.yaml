type: leaky
name: crowdsecurity/http-dos-bypass-cache
description: "Detect DoS tools bypassing cache every request"
filter: "evt.Meta.log_type == 'http_access-log' && int(evt.Meta.http_args_len) >= 7 && int(evt.Meta.http_args_len) <= 12 && evt.Parsed.http_args matches '^[0-9]+$' && evt.Parsed.static_ressource == 'false'"
distinct: "evt.Parsed.http_args"
leakspeed: 1s
capacity: 30
#debug: true
cache_size: 10
groupby: "evt.Meta.source_ip"
blackhole: 1m
labels:
 service: http
 remediation: true
