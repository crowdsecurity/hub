type: trigger
name: sigma/web_cve_2014_6287_hfs_rce
description: |
  Detects attempts to exploit a Rejetto HTTP File Server (HFS) via CVE-2014-6287
filter: |
  evt.Meta.service == 'http' && (Match("*?search=%00{.*", evt.Parsed.http_args) && (evt.Parsed.http_args contains "save|" || evt.Parsed.http_args contains "powershell" || evt.Parsed.http_args contains "cmd.exe" || evt.Parsed.http_args contains "cmd /c" || evt.Parsed.http_args contains "cmd /r" || evt.Parsed.http_args contains "cmd /k" || evt.Parsed.http_args contains "cscript" || evt.Parsed.http_args contains "wscript" || evt.Parsed.http_args contains "python" || evt.Parsed.http_args contains "C:\\Users\\Public\\" || evt.Parsed.http_args contains "%comspec%"))
blackhole: 2m
labels:
  type: exploit
  remediation: true
