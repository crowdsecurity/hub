type: trigger
name: sigma/web_exchange_owassrf_poc_exploitation
description: |
  Detects exploitation attempt of the OWASSRF variant targeting exchange servers using publicly available POC. It uses the OWA endpoint to access the powershell backend endpoint
filter: |
  evt.Meta.service == 'http' && (evt.Meta.http_user_agent == "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.5195.54 Safari/537.36" && evt.Meta.http_verb == "POST" && int(evt.Meta.http_status) == 200 && (evt.Parsed.http_args contains "/owa/mastermailbox" && evt.Parsed.http_args contains "/powershell"))
blackhole: 2m
labels:
  type: exploit
  remediation: true
