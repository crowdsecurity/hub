type: trigger
name: sigma/web_cve_2020_28188_terramaster_rce_exploit
description: |
  Detects the exploitation of the TerraMaster TOS vulnerability described in CVE-2020-28188
filter: |
  evt.Meta.service == 'http' && ((evt.Meta.http_verb == "GET" && (evt.Parsed.http_args contains "/include/makecvs.php" && Match("*?Event=*", evt.Parsed.http_args))) && (evt.Parsed.http_args contains "curl" || evt.Parsed.http_args contains "wget" || evt.Parsed.http_args contains ".py" || evt.Parsed.http_args contains ".sh" || evt.Parsed.http_args contains "chmod" || evt.Parsed.http_args contains "_GET"))
blackhole: 2m
labels:
  type: exploit
  remediation: true
