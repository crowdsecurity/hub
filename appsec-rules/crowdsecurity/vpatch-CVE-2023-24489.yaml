name: crowdsecurity/vpatch-CVE-2023-24489
description: "Citrix ShareFile RCE (CVE-2023-24489)"
rules:
  - and:
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: endsWith
        value: /documentum/upload.aspx
    - zones:
      - METHOD
      match:
        type: equals
        value: POST
    - zones:
      - ARGS
      variables:
       - uploadid
      match:
        type: contains
        value: ".."
    - zones:
      - RAW_BODY
#it seems 'Page_Load' is the handler that can be abused, maybe some others can?
      match:
        type: contains
        value: "Page_Load"
labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "Citrix ShareFile RCE"
  classification:
   - cve.CVE-2023-24489
   - attack.T1595
   - attack.T1190
   - cwe.CWE-284