name: crowdsecurity/vpatch-CVE-2025-25257
description: "Fortinet FortiWeb Fabric Connector - Pre-Authenticated SQL Injection (CVE-2025-25257)"
#https://labs.watchtowr.com/pre-auth-sql-injection-to-rce-fortinet-fortiweb-fabric-connector-cve-2025-25257/
rules:
  - and:
      - zones:
          - METHOD
        match:
          type: equals
          value: GET
      - zones:
          - URI
        transform:
          - lowercase
        match:
          type: regex
          value: /api/(fabric/device/status|v[0-9]/fabric/widget)
      - zones:
          - HEADERS
        variables:
          - Authorization
        match:
          type: contains
          value: "'"

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "Fortinet FortiWeb Fabric Connector - Pre-Authenticated SQL Injection"
  classification:
    - cve.CVE-2025-25257
    - attack.T1190
    - cwe.CWE-89
