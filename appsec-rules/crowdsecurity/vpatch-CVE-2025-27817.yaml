## autogenerated on 2026-02-11 14:36:16
name: crowdsecurity/vpatch-CVE-2025-27817
description: 'Detects Apache Kafka Client arbitrary file read via untrusted sasl.oauthbearer.token.endpoint.url in Druid sampler endpoint.'
rules:
  - and:
      - zones:
          - URI
        transform:
          - lowercase
        match:
          type: contains
          value: /druid/indexer/v1/sampler
      - zones:
          - BODY_ARGS_NAMES
        transform:
          - lowercase
        match:
          type: contains
          value: sasl.oauthbearer.token.endpoint.url
      - zones:
          - BODY_ARGS
        variables:
          - json.spec.ioConfig.consumerProperties.sasl.oauthbearer.token.endpoint.url
        transform:
          - lowercase
        match:
          type: contains
          value: file://

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: 'http:exploit'
  label: 'Apache Kafka - LFI'
  classification:
    - cve.CVE-2025-27817
    - attack.T1190
    - cwe.CWE-918
