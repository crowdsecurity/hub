name: crowdsecurity/vpatch-CVE-2025-64446
description: 'Detects FortiWeb authentication bypass via path traversal and CGIINFO header with admin impersonation'
rules:
  - and:
      - zones:
          - URI
        transform:
          - urldecode
          - lowercase
        match:
          type: contains
          value: '/api/v2.0/cmdb/system/admin'
      - zones:
          - URI
        transform:
          - urldecode
          - lowercase
        match:
          type: contains
          value: '../'
      - zones:
          - URI
        transform:
          - urldecode
          - lowercase
        match:
          type: contains
          value: '/cgi-bin/fwbcgi'
      - zones:
          - HEADERS
        variables:
          - CGIINFO
        transform:
          - b64decode
          - lowercase
        match:
          type: contains
          value: 'admin'

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: 'http:exploit'
  label: 'FortiWeb - Authentication Bypass'
  classification:
    - cve.CVE-2025-64446
    - attack.T1190
    - cwe.CWE-23