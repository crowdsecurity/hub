name: crowdsecurity/vpatch-CVE-2023-0900
description: "AP Pricing Tables Lite - SQL Injection (CVE-2023-0900)"
rules:
  - and:
    - zones:
      - METHOD
      match:
        type: equals
        value: POST
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: contains
        value: /wp-admin/admin-ajax.php
    - zones:
      - BODY_ARGS
      variables:
      - action
      transform:
      - lowercase
      match:
        type: equals
        value: backend_ajax
    - zones:
      - BODY_ARGS
      variables:
      - _action
      transform:
      - lowercase
      match:
        type: equals
        value: copy_table
    - zones:
      - BODY_ARGS
      variables:
      - table_id
      match:
        type: libinjectionSQL

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "AP Pricing Tables Lite - SQL Injection"
  classification:
   - cve.CVE-2023-0900
   - attack.T1595
   - attack.T1190
   - cwe.CWE-89