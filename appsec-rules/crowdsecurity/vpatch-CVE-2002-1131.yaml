## autogenerated on 2025-04-23 12:56:40
name: crowdsecurity/vpatch-CVE-2002-1131
description: 'Detects XSS attempts in SquirrelMail 1.2.6/1.2.7 via unsanitized input in addressbook, options, search, and help modules.'
rules:
  - and:
      - zones:
          - URI
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: /src/addressbook.php
      - zones:
          - ARGS_NAMES
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: <
  - and:
      - zones:
          - URI
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: /src/options.php
      - zones:
          - ARGS
        variables:
          - optpage
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: <
  - and:
      - zones:
          - URI
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: /src/search.php
      - zones:
          - ARGS
        variables:
          - mailbox
          - where
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: <
  - and:
      - zones:
          - URI
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: /src/help.php
      - zones:
          - ARGS
        variables:
          - chapter
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: <

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: 'http:exploit'
  label: 'SquirrelMail - XSS'
  classification:
    - cve.CVE-2002-1131
    - attack.T1059
    - cwe.CWE-80
