name: crowdsecurity/vpatch-CVE-2018-20062
description: "ThinkPHP - RCE (CVE-2018-20062)"
rules:
  - and:
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: endsWith
        value: index.php
    - zones:
      - ARGS
      variables:
      - s
      transform:
      - lowercase
      match:
        type: contains
        value: think
    - zones:
      - ARGS
      variables:
      - s
      transform:
      - lowercase
      match:
        type: regex
        value: "[^A-Za-z0-9_.]*"
labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "ThinkPHP - RCE"
  references:
    - https://nvd.nist.gov/vuln/detail/CVE-2018-20062
    - https://www.exploit-db.com/exploits/45978
  classification:
   - cve.CVE-2018-20062
   - attack.T1595
   - attack.T1190
