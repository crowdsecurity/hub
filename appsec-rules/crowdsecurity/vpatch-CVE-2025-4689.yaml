name: crowdsecurity/vpatch-CVE-2025-4689
description: 'Detects WordPress Ads Pro Plugin unauthenticated SQLi + LFI chain via wp-ajax endpoint targeting a_id parameter (CVE-2025-4689)'
rules:
  - and:
      - zones:
          - URI
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: '/wp-admin/admin-ajax.php'
      - zones:
          - ARGS
        variables:
          - action
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: 'bsa_pro'
      - zones:
          - ARGS
        variables:
          - a_id
        transform:
          - lowercase
          - urldecode
        match:
          type: regex
          value: "[^0-9]"
labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: 'http:exploit'
  label: 'WordPress Ads Pro Plugin - SQLI'
  classification:
    - cve.CVE-2025-4689
    - attack.T1190
    - cwe.CWE-89