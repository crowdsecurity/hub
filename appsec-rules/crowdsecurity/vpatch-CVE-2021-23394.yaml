## autogenerated on 2026-02-11 14:25:29
name: crowdsecurity/vpatch-CVE-2021-23394
description: 'Detects creation of .phar files via elFinder connector, which may lead to remote code execution if parsed as PHP.'
rules:
  - and:
      - zones:
          - URI
        transform:
          - lowercase
        match:
          type: contains
          value: /elfinder/php/connector.minimal.php
      - zones:
          - ARGS
        variables:
          - name
        transform:
          - lowercase
          - urldecode
        match:
          type: endsWith
          value: .phar
      - zones:
          - ARGS
        variables:
          - cmd
        transform:
          - lowercase
        match:
          type: equals
          value: mkfile

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: 'http:exploit'
  label: 'ElFinder - RCE'
  classification:
    - cve.CVE-2021-23394
    - attack.T1190
    - cwe.CWE-434
