## autogenerated on 2025-10-29 15:19:07
name: crowdsecurity/vpatch-CVE-2022-24086
description: 'Detects RCE in Adobe Commerce (Magento) via crafted JSON in checkout process (CVE-2022-24086)'
rules:
  - and:
      - zones:
          - URI
        transform:
          - lowercase
        match:
          type: contains
          value: /rest/default/v1/guest-carts/
      - zones:
          - URI
        transform:
          - lowercase
        match:
          type: contains
          value: /shipping-information
      - zones:
          - BODY_ARGS
        variables:
          - 'json.addressInformation.shipping_address.firstname'
        transform:
          - lowercase
        match:
          type: contains
          value: 'addafterfiltercallback(system)'

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: 'http:exploit'
  label: 'Adobe Commerce - RCE'
  classification:
    - cve.CVE-2022-24086
    - attack.T1190
    - cwe.CWE-20
