
name: crowdsecurity/vpatch-CVE-2023-34362
debug: true
description: "Detect CVE-2023-34362 exploits "
rules:
  - and:
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: equals
        value: /moveitisapi/moveitisapi.dll
    - zones:
      - ARGS
      variables:
      - action
      match:
        type: equals
        value: m2
      transform:
      - lowercase
    - zones:
      - METHOD
      match:
        type: equals
        value: POST
    - zones:
      - HEADERS
      variables:
      - X-siLock-Transaction
      match:
        type: equals
        value: 'session_setvars'
    - zones:
      - HEADERS_NAMES
      transform:
       - lowercase
      match:
        type: startsWith
        value: 'x-silock-sessvar'
    - zones:
      - HEADERS
      match:
        type: libinjectionSQL
labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "MOVEit Transfer - Remote Code Execution (CVE-2023-34362)"
  classification:
   - cve.CVE-2023-34362
   - attack.T1595
   - attack.T1190
   - cwe.CWE-502