name: crowdsecurity/vpatch-CVE-2023-47218
description: "QNAP QTS - RCE (CVE-2023-47218)"
rules:
  - and:
      - zones:
          - METHOD
        match:
          type: equals
          value: POST
      - zones:
          - URI
        transform:
          - lowercase
        match:
          type: endsWith
          value: /cgi-bin/quick/quick.cgi
      - zones:
          - ARGS
        variables:
          - func
        transform:
          - lowercase
        match:
          type: equals
          value: "switch_os"
      - zones:
          - ARGS
        variables:
          - todo
        transform:
          - lowercase
        match:
          type: equals
          value: "uploaf_firmware_image"
labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "QNAP QTS - RCE"
  classification:
    - cve.CVE-2023-47218
    - attack.T1595
    - attack.T1190
    - cwe.CWE-78
    - cwe.CWE-77
