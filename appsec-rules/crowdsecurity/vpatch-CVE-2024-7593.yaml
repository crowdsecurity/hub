name: crowdsecurity/vpatch-CVE-2024-7593
description: "Ivanti vTM - Authentication Bypass (CVE-2024-7593)"
rules:
  - and:
    - zones:
        - METHOD
      match:
        type: equals
        value: POST
    - zones:
        - URI
      transform:
        - lowercase
      match:
        type: endsWith
        value: /apps/zxtm/wizard.fcgi
    - zones:
        - ARGS
      variables:
        - section
      transform:
        - lowercase
        - urldecode
      match:
        type: equals
        value: "access management:localusers"
    - zones:
        - ARGS
      variables:
        - error
      transform:
        - lowercase
      match:
        type: equals
        value: 1
    - zones:
        - BODY_ARGS
      variables:
        - create_user
      match:
        type: equals
        value: Create
    - zones:
        - BODY_ARGS
      variables:
        - group
      match:
        type: equals
        value: admin
    - zones:
        - BODY_ARGS
      variables:
        - newusername
      match:
        type: regex
        value: ^.*$
    - zones:
        - BODY_ARGS
      variables:
        - password1
      match:
        type: regex
        value: ^.*$

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "Ivanti vTM - Authentication Bypass"
  classification:
    - cve.CVE-2024-7593
    - attack.T1190
    - cwe.CWE-287
    - cwe.CWE-303