name: crowdsecurity/vpatch-CVE-2023-33617
description: "Atlassian Confluence Privesc (CVE-2023-33617)"
rules:
  - and:
    - zones:
      - METHOD
      transform:
      - lowercase
      match:
        type: equals
        value: post
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: endsWith
        value: /boaform/admin/formlogin
    - zones:
      - BODY_ARGS
      variables:
       - username
      transform:
      - lowercase
      match:
        type: equals
        value: "admin"
    - zones:
      - BODY_ARGS
      variables:
       - psd
      transform:
      - lowercase
      match:
        type: equals
        value: "parks"
  - and:
    - zones:
      - METHOD
      match:
        type: equals
        value: POST
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: endsWith
        value: /boaform/admin/formping
    - zones:
      - BODY_ARGS
      variables:
      - target_addr
      transform:
      - lowercase
      match:
        type: regex
        value: "[^a-f0-9:.]+"
labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "Atlassian Confluence Privesc"
  classification:
   - cve.CVE-2023-33617
   - attack.T1595
   - attack.T1190
   - cwe.CWE-78