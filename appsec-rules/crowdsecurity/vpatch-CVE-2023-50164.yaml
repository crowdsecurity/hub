name: crowdsecurity/vpatch-CVE-2023-50164
description: "Apache Struts2 Path Traversal (CVE-2023-50164)"
rules:
  - and:
    - zones:
      - METHOD
      match:
        type: equals
        value: POST
    - zones:
      - BODY_ARGS
#it might be used both in POST and GET args: https://trganda.github.io/notes/security/vulnerabilities/apache-struts/Apache-Struts-Remote-Code-Execution-Vulnerability-(-S2-066-CVE-2023-50164)
      - ARGS
      variables:
      - /.+filename$/
      match:
        type: contains
        value: "../"
labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "Apache Struts2 Path Traversal"
  classification:
   - cve.CVE-2023-50164
   - attack.T1595
   - attack.T1190
   - cwe.CWE-552


