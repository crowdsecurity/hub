name: crowdsecurity/vpatch-CVE-2018-1000861
description: "Jenkins - RCE (CVE-2018-1000861)"
rules:
  - and:
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: endsWith
        value: descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile
  - and:
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: endsWith
        value: securityRealm/user/admin
labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "Jenkins - RCE"
  references:
    - https://www.youtube.com/watch?v=abuH-j-6-s0&t=7s
    - https://devco.re/blog/2019/02/19/hacking-Jenkins-part2-abusing-meta-programming-for-unauthenticated-RCE/
  classification:
   - cve.CVE-2018-1000861
   - attack.T1595
   - attack.T1190
   - cwe.CWE-502