name: crowdsecurity/vpatch-CVE-2024-29849
description: "Veeam Backup Enterprise Manager - Authentication Bypass (CVE-2024-29849)"
rules:
  - and:
    - zones:
      - URI
      match:
        type: endsWith
        value: /api/sessionMngr/
    - zones:
      - METHOD
      match:
        type: equals
        value: POST
    - zones:
      - ARGS
      variables:
        - v
      match:
        type: equals
        value: "latest"
    - zones:
      - BODY_ARGS
      transform:
        - b64decode
      variables:
        - json.VMwareSSOToken
      match:
        type: contains
        value: "<saml2:Assertion"
    - zones:
        - BODY_ARGS
      variables:
        - json.VMwareSSOToken
      transform:
        - b64decode
      match:
        type: contains
        value: "<saml2:Issuer"
    - zones:
        - BODY_ARGS
      variables:
        - json.VMwareSSOToken
      transform:
        - b64decode
      match:
        type: contains
        value: "/STSService"

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "Veeam Backup Enterprise Manager - Authentication Bypass"
  classification:
    - cve.CVE-2024-29849
    - attack.T1595
    - attack.T1190
