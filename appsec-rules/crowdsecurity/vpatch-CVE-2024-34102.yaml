
name: crowdsecurity/vpatch-CVE-2024-34102
description: "Adobe Commerce & Magento - XXE (CVE-2024-34102)"
rules:
  - and:
    - zones:
      - METHOD
      transform:
      - uppercase
      match:
        type: equals
        value: POST
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: contains
        value: /rest/v1/guest-carts/1/estimate-shipping-methods
    - zones:
      - BODY_ARGS
      variables:
      - json.address.totalsCollector.collectorList.totalCollector.sourceData.data
      transform:
        - lowercase
      match:
        type: contains
        value: "<!entity"
  - and:
    - zones:
      - METHOD
      transform:
      - lowercase
      match:
        type: equals
        value: post
    - zones:
      - URI
      transform:
      - lowercase
      match:
        type: contains
        value: /rest/v1/guest-carts/1/estimate-shipping-methods
    - zones:
      - BODY_ARGS
      variables:
      - json.address.totalsCollector.collectorList.totalCollector.sourceData.data
      transform:
        - lowercase
      match:
        type: contains
        value: "://"
    - zones:
      - BODY_ARGS
      variables:
      - json.address.totalsCollector.collectorList.totalCollector.sourceData.dataIsURL
      transform:
        - lowercase
      match:
        type: equals
        value: "true"


labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: "http:exploit"
  label: "Adobe Commerce & Magento - XXE"
  classification:
   - cve.CVE-2024-34102
   - attack.T1595
   - attack.T1190
   - cwe.CWE-611