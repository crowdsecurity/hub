## autogenerated on 2025-10-29 15:22:01
name: crowdsecurity/vpatch-CVE-2021-32478
description: 'Detects reflected XSS and open redirect in Moodle LTI authorization endpoint via unsanitized redirect_uri parameter.'
rules:
  - and:
      - zones:
          - URI
        transform:
          - lowercase
        match:
          type: contains
          value: /mod/lti/auth.php
      - zones:
          - ARGS
        variables:
          - redirect_uri
        transform:
          - lowercase
          - urldecode
        match:
          type: contains
          value: 'javascript:'

labels:
  type: exploit
  service: http
  confidence: 3
  spoofable: 0
  behavior: 'http:exploit'
  label: 'Moodle - XSS'
  classification:
    - cve.CVE-2021-32478
    - attack.T1059
    - cwe.CWE-79
