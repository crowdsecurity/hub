name: custom/pihole-logs
description: Parser for Pi-hole logs on ARM/Armbian (dnsmasq/syslog format)
filter: "evt.Line.Labels.type == 'pihole'"
onsuccess: next_stage

pattern_syntax:
  SYSLOGDATE: '[A-Z][a-z]{2} +[0-9]{1,2} [0-9]{2}:[0-9]{2}:[0-9]{2}'

nodes:
  - grok:
      pattern: "%{SYSLOGDATE:timestamp} %{WORD:process}\\[%{NUMBER:pid}\\]: %{GREEDYDATA:message}"
      apply_on: message

