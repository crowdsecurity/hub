onsuccess: next_stage
filter: "evt.Parsed.program == 'postal'"
name: crowdsecurity/postal-logs
description: "Parse SMTP authentication failure in postal logs"
debug: false
# Example log : 
# smtp-1  | 2025-07-10 15:12:17 +0000 WARN   Authentication failure for 1.2.3.4 trace_id=4M5NHUW8 component=smtp-server
nodes:
    - grok:
          pattern: '%{RAILS_TIMESTAMP:timestamp} WARN   Authentication failure for %{IP:source_ip}'
          apply_on: message
          statics:
              - meta: log_type
                value: postal_failed_auth
              - target: evt.StrTime
                expression: evt.Parsed.timestamp
statics:
    - meta: service
      value: postal
    - meta: source_ip
      expression: "evt.Parsed.source_ip"
    - target: evt.StrTime
      expression: evt.Parsed.timestamp
