onsuccess: next_stage
debug: true
filter: "evt.Parsed.program == 'coraza-waap'"
name: crowdsecurity/appsec-logs
description: "Parse Appsec events"
statics:
  - meta: service
    value: appsec
  - meta: source_ip
    expression: "evt.Parsed.source_ip"
  - meta: target_host
    expression: "evt.Parsed.target_host"
  - meta: request_uuid
    expression: "evt.Parsed.req_uuid"
  - meta: target_uri
    expression: "evt.Parsed.target_uri"
  - meta: log_type
    value: appsec-block
  - meta: rule_name
    expression: evt.Appsec.GetName()
  - meta: rule_ids
    expression: Sprintf("%+v", evt.Appsec.GetRuleIDs())
