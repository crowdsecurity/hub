onsuccess: next_stage
filter: "evt.Parsed.cef_device_vendor == 'Ubiquiti' && evt.Parsed.cef_device_product == 'UniFi Network' && ParseKVLax(evt.Parsed.message, evt.Unmarshaled, 'unifi') == nil"
name: crowdsecurity/unifi-cef
description: "Parse Unifi CEF logs"
statics:
  - meta: service
    value: unifi
  - meta: vendor
    expression: evt.Parsed.cef_device_vendor
  - meta: product
    expression: evt.Parsed.cef_device_product
  - meta: device_version
    expression: evt.Parsed.cef_device_version
  - meta: event_severity
    expression: evt.Parsed.cef_severity
  - meta: event_signature_id
    expression: evt.Parsed.cef_signature_id
  - meta: source_ip
    expression: evt.Unmarshaled.unifi.src
  - meta: protocol
    expression: evt.Unmarshaled.unifi.proto
  - meta: source_port
    expression: evt.Unmarshaled.unifi.spt
  - meta: destination_ip
    expression: evt.Unmarshaled.unifi.dst
  - meta: destination_port
    expression: evt.Unmarshaled.unifi.dpt
  - meta: action
    expression: evt.Unmarshaled.unifi.act
  - meta: application
    expression: evt.Unmarshaled.unifi.app
  - meta: category
    expression: evt.Unmarshaled.unifi.UNIFIcategory
  - meta: subcategory
    expression: evt.Unmarshaled.unifi.UNIFIsubCategory
  - meta: host
    expression: evt.Unmarshaled.unifi.UNIFIhost
  - meta: risk_level
    expression: evt.Unmarshaled.unifi.UNIFIrisk
  - meta: policy_name
    expression: evt.Unmarshaled.unifi.UNIFIpolicyName
  - meta: policy_type
    expression: evt.Unmarshaled.unifi.UNIFIpolicyType
  - meta: direction
    expression: evt.Unmarshaled.unifi.UNIFIdirection
  - meta: device_interface
    expression: evt.Unmarshaled.unifi.deviceInboundInterface
  - meta: device_mac
    expression: evt.Unmarshaled.unifi.UNIFIdeviceMac
  - meta: device_name
    expression: evt.Unmarshaled.unifi.UNIFIdeviceName
  - meta: device_model
    expression: evt.Unmarshaled.unifi.UNIFIdeviceModel
  - meta: device_ip
    expression: evt.Unmarshaled.unifi.UNIFIdeviceIp
  - meta: device_firmware_version
    expression: evt.Unmarshaled.unifi.UNIFIdeviceVersion
  - meta: source_zone
    expression: evt.Unmarshaled.unifi.UNIFIsrcZone
  - meta: source_region
    expression: evt.Unmarshaled.unifi.UNIFIsrcRegion
  - meta: destination_client_alias
    expression: evt.Unmarshaled.unifi.UNIFIdstClientAlias
  - meta: destination_client_mac
    expression: evt.Unmarshaled.unifi.UNIFIdstClientMac
  - meta: destination_zone
    expression: evt.Unmarshaled.unifi.UNIFIdstZone
  - meta: admin_user
    expression: evt.Unmarshaled.unifi.UNIFIadmin
  - meta: access_method
    expression: evt.Unmarshaled.unifi.UNIFIaccessMethod
  - meta: ips_signature
    expression: evt.Unmarshaled.unifi.UNIFIipsSignature
  - meta: ips_signature_id
    expression: evt.Unmarshaled.unifi.UNIFIipsSignatureId
  - meta: ips_session_id
    expression: evt.Unmarshaled.unifi.UNIFIipsSessionId
  - meta: message
    expression: evt.Unmarshaled.unifi.msg
  - target: evt.StrTime
    expression: evt.Unmarshaled.unifi.UNIFIutcTime
