name: crowdsecurity/calibre-web-whitelist
description: "Whitelist events from calibre-web"
filter: "evt.Meta.service == 'http' && evt.Meta.log_type in ['http_access-log', 'http_error-log']"
whitelist:
  reason: "Calibre-Web whitelist"
  expression:
   - evt.Meta.http_status in ['200', '304'] && evt.Meta.http_verb == 'GET' && evt.Meta.http_path matches '^\\/cover\\/(\\d+)\\/md\\?c=(\\d+)$' # When loading book covers
