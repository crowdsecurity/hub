id: vpatch-CVE-2025-49113
info:
  name: vpatch-CVE-2025-49113
  author: crowdsec
  severity: info
  description: vpatch-CVE-2025-49113 testing
  tags: appsec-testing
http:
#this is a dummy request, edit the request(s) to match your needs
  - raw:
    - |
      POST /?_task=settings&_framed=1&_remote=1&_from=!";O:16:"Crypt_GPG_Engine":1:{s:8:"_gpgconf";s:1234:"bash+-c+"printf+'curl+asd'>/tmp/p;bash+/tmp/p";";}}&_action=upload HTTP/1.1
      Host: {{Hostname}}
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryxc4v9AJAwaNTZhjk

      ------WebKitFormBoundaryxc4v9AJAwaNTZhjk
      Content-Disposition: form-data; name="_file[]"; filename="firstfile|a:1:{s:57:\"a\";}"
      Content-Type: image/png
      
      {{base64_decode('iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg==')}}
      ------WebKitFormBoundaryxc4v9AJAwaNTZhjk--
    - |
      POST /?_task=settings&_framed=1&_remote=1&_from=foobar&_action=upload HTTP/1.1
      Host: {{Hostname}}
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryxc4v9AJAwaNTZhjk

      ------WebKitFormBoundaryxc4v9AJAwaNTZhjk
      Content-Disposition: form-data; name="_file[]"; filename="firstfile|a:1:{s:57:\"a\";}"
      Content-Type: image/png
      
      {{base64_decode('iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg==')}}
      ------WebKitFormBoundaryxc4v9AJAwaNTZhjk--

    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: dsl
      condition: and
      dsl:
        - 'status_code_1 == 403'
        - 'status_code_2 == 405' # POST on static page, nginx returns a 405 if request goes through
