id: vpatch-CVE-2024-38856
info:
  name: vpatch-CVE-2024-38856
  author: crowdsec
  severity: info
  description: vpatch-CVE-2024-38856 testing
  tags: appsec-testing
http:
  - raw:
    - |
      POST /{{randstr}}/webtools/control/forgotPassword/ProgramExport HTTP/1.1
      Content-Type: application/x-www-form-urlencoded
      Host: {{Hostname}}

      groovyProgram=throw+new+Exception('id'.execute().text)
    - |
      POST /{{randstr}}/webtools/control/main/ProgramExport HTTP/1.1
      Content-Type: application/x-www-form-urlencoded
      Host: {{Hostname}}

      groovyProgram=throw+new+Exception('id'.execute().text)
    - |
      POST /{{randstr}}/webtools/control/view/ProgramExport HTTP/1.1
      Content-Type: application/x-www-form-urlencoded
      Host: {{Hostname}}

      groovyProgram=throw+new+Exception('id'.execute().text)#
    - |
      POST /{{randstr}}/webtools/control/testService/ProgramExport HTTP/1.1
      Content-Type: application/x-www-form-urlencoded
      Host: {{Hostname}}

      groovyProgram=throw+new+Exception('id'.execute().text)
    - |
      GET /{{randstr}}/webtools/control/testService/ProgramExport?groovyProgram=throw+new+Exception('id'.execute().text) HTTP/1.1
      Host: {{Hostname}}

    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
      - type: dsl
        condition: and
        dsl:
          - "status_code_1 == 403"
          - "status_code_2 == 403"
          - "status_code_3 == 403"
          - "status_code_4 == 403"
          - "status_code_5 == 403"
