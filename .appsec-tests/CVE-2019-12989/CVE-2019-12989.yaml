id: CVE-2019-12989
info:
  name: CVE-2019-12989
  author: crowdsec
  severity: info
  description: CVE-2019-12989 testing
  tags: appsec-testing
http:
#this is a dummy request, edit the request(s) to match your needs
  - raw:
    - |
      POST /sdwan/nitro/v1/config/get_package_file?action=file_download HTTP/1.1
      Host: {{Hostname}}
      SSL_CLIENT_VERIFY: SUCCESS
      Content-Type: application/json
      Content-Length: 178

      {"get_package_file": {"site_name": "blah' union select 'tenable','zero','day','research' INTO OUTFILE '/tmp/token_01234';#","appliance_type": "primary","package_type": "active"}}
    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: status
      status:
       - 403
