id: vpatch-CVE-2024-4577
info:
  name: vpatch-CVE-2024-4577
  author: crowdsec
  severity: info
  description: vpatch-CVE-2024-4577 testing
  tags: appsec-testing
http:
  - method: POST
    path:
      - "{{BaseURL}}/php-cgi/php-cgi.exe?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input"
      - "{{BaseURL}}/index.php?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input"
      - "{{BaseURL}}/test.php?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input"
      - "{{BaseURL}}/test.hello?%ADd+cgi.force_redirect%3d0+%ADd+cgi.redirect_status_env+%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input"
      - "{{BaseURL}}/foo.php"
    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: dsl
      condition: and
      dsl:
        - 'status_code_1 == 403'
        - 'status_code_2 == 403'
        - 'status_code_3 == 403'
        - 'status_code_4 == 403'
        - 'status_code_5 == 404'
