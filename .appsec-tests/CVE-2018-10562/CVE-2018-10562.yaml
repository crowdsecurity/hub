id: CVE-2018-10562
info:
  name: CVE-2018-10562
  author: crowdsec
  severity: info
  description: CVE-2018-10562 testing
  tags: appsec-testing
http:
  - raw:
    - |
      POST /GponForm/diag_Form?images/ HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded

      XWebPageName=diag&diag_action=ping&wan_conlist=0&dest_host=127.0.0.1;`echo zMEw;uname -a;echo zMEw`;&ipv=0

    - | # legit request
      POST /GponForm/diag_Form?images/ HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded

      XWebPageName=diag&diag_action=ping&wan_conlist=0&dest_host=www.my-domain.com

    cookie-reuse: true
    matchers:
    - type: dsl
      condition: and
      dsl:
        - 'status_code_1 == 403'
        - 'status_code_2 == 404' # waf will return 200 but NGINX will return 404
