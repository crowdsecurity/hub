id: CVE-2023-24489
info:
  name: CVE-2023-24489
  author: crowdsec
  severity: info
  description: CVE-2023-24489 testing
  tags: appsec-testing
variables:
  fileName: '{{rand_base(8)}}'
  #in real life padding varies to abuse the crypto bug
  padding: 'QUFBQUFBQUFBQUFBQUFBAEFBQUFBQUFBQUFBQUFBQUE='
http:
  - raw:
      - |
        POST /documentum/upload.aspx?parentid={{padding}}&raw=1&unzip=on&uploadid={{fileName}}\..\..\..\cifs&filename={{fileName}}.aspx HTTP/1.1
        Host: {{Hostname}}

        <%@ Page Language="C#" Debug="true" Trace="false" %>
        <script Language="c#" runat="server">
        void Page_Load(object sender, EventArgs e)
        {
            Response.Write("{{randstr}}");
        }
        </script>

    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: status
      status:
       - 403