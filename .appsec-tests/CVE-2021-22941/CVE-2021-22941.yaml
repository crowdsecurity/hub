id: CVE-2021-22941
info:
  name: CVE-2021-22941
  author: crowdsec
  severity: info
  description: CVE-2021-22941 testing
  tags: appsec-testing
http:
#this is a dummy request, edit the request(s) to match your needs
  - raw:
    - |
      POST /upload.aspx?uploadid=%40using+System.Diagnostics%3B%40%7Bint+idx0%3D+0%3Bstring+str_idx0+%3D+idx0.ToString%28%29%3B+int+idx1+%3D+1%3Bstring+str_idx1+%3D+idx1.ToString%28%29%3Bstring+cmd+%3D+Request.QueryString%5Bstr_idx0%5D%3Bstring+arg+%3D+Request.QueryString%5Bstr_idx1%5D%3BProcess.Start%28cmd%2Carg%29%3B%7D%2F..%2F..%2FConfigService%5CViews%5CShared%5CError.cshtml&bp=123&accountid=123 HTTP/1.1
      Host: 127.0.0.1:4241
      User-Agent: python-requests/2.28.2
      Accept-Encoding: gzip, deflate, br
      Accept: */*
      Connection: keep-alive
      Content-Type: multipart/form-data; boundary=boundary
      Content-Length: 104

      --boundary
      Content-Disposition: form-data; name="text4"; filename="text5"

      V8C7BH6OHT
      --boundary--
    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: status
      status:
       - 403
