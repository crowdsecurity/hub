id: CVE-2023-50164
info:
  name: CVE-2023-50164
  author: crowdsec
  severity: info
  description: CVE-2023-50164 testing
  tags: appsec-testing
http:
  - raw:
    - |
      POST /s2_066_war_exploded/upload.action HTTP/1.1
      Host: {{Hostname}}
      Accept-Language: en-US,en;q=0.9
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
      Accept-Encoding: gzip, deflate, br
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundary5WJ61X4PRwyYKlip
      Content-Length: 593
      
      ------WebKitFormBoundary5WJ61X4PRwyYKlip
      Content-Disposition: form-data; name="upload"; filename="poc.txt"
      Content-Type: text/plain
      
      test
      
      
      ------WebKitFormBoundary5WJ61X4PRwyYKlip
      Content-Disposition: form-data; name="uploadFileName";
      
      ../../poc.txt
      
      ------WebKitFormBoundary5WJ61X4PRwyYKlip--
    - |
      POST /s2_066_war_exploded/upload.action HTTP/1.1
      Host: {{Hostname}}
      Accept-Language: en-US,en;q=0.9
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
      Accept-Encoding: gzip, deflate, br
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundary5WJ61X4PRwyYKlip
      Content-Length: 593
      
      ------WebKitFormBoundary5WJ61X4PRwyYKlip
      Content-Disposition: form-data; name="upload"; filename="poc.txt"
      Content-Type: text/plain
      
      test
      
      
      ------WebKitFormBoundary5WJ61X4PRwyYKlip
      Content-Disposition: form-data; name="uPlOadFiLeNamE";
      
      ../../poc.txt
      
      ------WebKitFormBoundary5WJ61X4PRwyYKlip--
    - |
      POST /s2_066_war_exploded/upload.action?uploadFileName=../../poc.txt HTTP/1.1
      Host: {{Hostname}}
      Accept-Language: en-US,en;q=0.9
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
      Accept-Encoding: gzip, deflate, br
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundary5WJ61X4PRwyYKlip
      Content-Length: 593
      
      ------WebKitFormBoundary5WJ61X4PRwyYKlip
      Content-Disposition: form-data; name="upload"; filename="poc.txt"
      Content-Type: text/plain
      
      test
      
      
      ------WebKitFormBoundary5WJ61X4PRwyYKlip

    cookie-reuse: true
    matchers:
    - type: dsl
      condition: and
      dsl:
        - 'status_code_1 == 403'
        - 'status_code_2 == 403'
        - 'status_code_3 == 403'
