id: cve-2023-33617
info:
  name: cve-2023-33617
  author: crowdsec
  severity: info
  description: cve-2023-33617 testing
  tags: appsec-testing
http:
#we're testing two requests:
# 1. login with default creds
# 2. exploitation of the actual vuln
# 3. the last one shouldn't match
  - raw:
    - |
      POST /boaform/admin/formLogin HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded

      username=admin&psd=parks
    - |
      POST /boaform/admin/formPing HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded

      target_addr=1.2.3.4;cat /etc/passwd
    - |
      POST /boaform/admin/formPing HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded

      target_addr=1.2.3.4
    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: dsl
      condition: and
      dsl:
        - 'status_code_1 == 403'
        - 'status_code_2 == 403'
        - 'status_code_3 == 404'