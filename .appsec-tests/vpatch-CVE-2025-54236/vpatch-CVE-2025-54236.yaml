id: vpatch-CVE-2025-54236
info:
  name: vpatch-CVE-2025-54236
  author: crowdsec
  severity: info
  description: vpatch-CVE-2025-54236 testing
  tags: appsec-testing
http:
#this is a dummy request, edit the request(s) to match your needs
  - raw:
    - |
      POST /customer/address_file/upload HTTP/1.1
      Host: {{Hostname}}
      User-Agent: curl/8.5.0
      Accept: */*
      Cookie: form_key=m3yBsO9mNcLnTFMa
      Content-Length: 686
      Content-Type: multipart/form-data; boundary=------------------------rlfq67OEZUw0PL869Vq3nN

      --------------------------rlfq67OEZUw0PL869Vq3nN
      Content-Disposition: form-data; name="form_key"

      m3yBsO9mNcLnTFMa
      --------------------------rlfq67OEZUw0PL869Vq3nN
      Content-Disposition: form-data; name="custom_attributes[first_name]"; filename="sess_va7m7lxj9s0fe8jiim6ud4gpvw"
      Content-Type: application/octet-stream

      _|O:31:"GuzzleHttp\Cookie\FileCookieJar":4:{S:7:"cookies";a:1:{i:0;O:27:"GuzzleHttp\Cookie\SetCookie":1:{S:4:"data";a:3:{S:7:"Expires";i:1;S:7:"Discard";b:0;S:5:"Value";S:20:"<?php phpinfo(); ?>\0a";}}}S:10:"strictMode";N;S:8:"filename";S:29:"/var/www/html/pub/exploit.php";S:19:"storeSessionCookies";b:1;}

      --------------------------rlfq67OEZUw0PL869Vq3nN--

    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: status
      status:
       - 403
