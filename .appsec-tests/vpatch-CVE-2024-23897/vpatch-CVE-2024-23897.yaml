id: vpatch-CVE-2024-23897
info:
  name: vpatch-CVE-2024-23897
  author: crowdsec
  severity: info
  description: vpatch-CVE-2024-23897 testing
  tags: appsec-testing
#\x00\x00\x00\x06\x00\x00\x04help\x00\x00\x00\x0e\x00\x00\x0c@/etc/passwd\x00\x00\x00\x05\x02\x00\x03GBK\x00\x00\x00\x07\x01\x00\x05zh_CN\x00\x00\x00\x00\x03
variables:
  payload: "{{hex_decode('0000000600000468656c700000000e00000c402f6574632f7061737377640000000502000347424b000000070100057a685f434e00000000030a')}}"
http:
#this is a dummy request, edit the request(s) to match your needs
  - raw:
    - |
      POST /cli?remoting=false HTTP/1.1
      Host: {{Hostname}}
      Side: upload
      Content-Type: application/octet-stream
      
      {{payload}}

    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: status
      status:
       - 403
