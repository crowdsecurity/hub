id: test-CVE-2023-47218
info:
  name: test-CVE-2023-47218
  author: crowdsec
  severity: info
  description: test-CVE-2023-47218 testing
  tags: appsec-testing
variables:
  file: "{{rand_base(6)}}"
  cmd: "%22$($(echo -n aWQ=|base64 -d)>{{file}})%22"
http:
  - raw:
      - |
        POST /cgi-bin/quick/quick.cgi?func=switch_os&todo=uploaf_firmware_image HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data;boundary="avssqwfz"

        --avssqwfz
        Content-Disposition: form-data; xxpcscma="field2"; zczqildp="{{cmd}}"
        Content-Type: text/plain

        skfqduny
        --avssqwfz-

    matchers:
      - type: status
        status:
          - 403
