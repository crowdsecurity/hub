id: vpatch-CVE-2018-20062
info:
  name: vpatch-CVE-2018-20062
  author: crowdsec
  severity: info
  description: vpatch-CVE-2018-20062 testing
  tags: appsec-testing
http:
#this is a dummy request, edit the request(s) to match your needs
  - raw:
    - |
      GET /public/index.php?s=/index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=php%20-r%20'phpinfo();' HTTP/1.1
      Host: {{Hostname}}
    - |
      GET /public/index.php?s=foo' HTTP/1.1
      Host: {{Hostname}}
    - |
      GET /public/index.php?s=' HTTP/1.1
      Host: {{Hostname}}


    cookie-reuse: true
#test will fail because we won't match http status 
    matchers:
    - type: dsl
      condition: and
      dsl:
       - "status_code_1 == 403"
       - "status_code_2 == 404"
       - "status_code_3 == 404"

