len(results) == 4
len(results["s00-raw"]["crowdsecurity/non-syslog"]) == 8
results["s00-raw"]["crowdsecurity/non-syslog"][0].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-10T23:50:05.533101+0000\",\"flow_id\":1258832998001901,\"in_iface\":\"bond0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.4\",\"src_port\":52812,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"metadata\":{\"flowbits\":[\"ET.formdata\",\"http.dottedquadhost\"]},\"community_id\":\"xx\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2024468,\"rev\":3,\"signature\":\"ET WEB_SPECIFIC_APPS OGNL Expression Injection (CVE-2017-9791)\",\"category\":\"Attempted User Privilege Gain\",\"severity\":1,\"metadata\":{\"affected_product\":[\"Apache_Struts2\"],\"attack_target\":[\"Web_Server\"],\"created_at\":[\"2017_07_14\"],\"deployment\":[\"Datacenter\"],\"former_category\":[\"WEB_SPECIFIC_APPS\"],\"performance_impact\":[\"Low\"],\"signature_severity\":[\"Major\"],\"updated_at\":[\"2020_08_10\"]},\"rule\":\"alert http any any -> $HTTP_SERVERS any (msg:\\\"ET WEB_SPECIFIC_APPS OGNL Expression Injection (CVE-2017-9791)\\\"; flow:established,to_server; http.method; content:\\\"POST\\\"; nocase; http.request_body; content:\\\"multipart\\\"; content:\\\"form-data\\\"; distance:1; within:11; content:\\\"ognl.OgnlContext\\\"; distance:1; fast_pattern; content:\\\"DEFAULT_MEMBER_ACCESS\\\"; distance:1; within:23; content:\\\"java.lang.ProcessBuilder\\\"; distance:1; content:\\\".start\\\"; distance:1; reference:url,securityonline.info/tutorial-cve-2017-9791-apache-struts2-s2-048-remote-code-execution-vulnerability/; reference:cve,2017-9791; classtype:attempted-user; sid:2024468; rev:3; metadata:affected_product Apache_Struts2, attack_target Web_Server, created_at 2017_07_14, deployment Datacenter, former_category WEB_SPECIFIC_APPS, performance_impact Low, signature_severity Major, updated_at 2020_08_10;)\"},\"files\":[{\"filename\":\"%{0b\",\"sid\":[],\"gaps\":false,\"state\":\"CLOSED\",\"stored\":false,\"size\":1,\"tx_id\":0}],\"app_proto\":\"http\",\"payload_printable\":\"POST /ind\\n\",\"stream\":1,\"packet\":\"xxx\",\"packet_info\":{\"linktype\":1}}"
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Parsed["program"] == "suricata-evelogs"
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Parsed["program"] == "suricata-evelogs"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-10T23:52:31.097119+0000\",\"flow_id\":836311304881252,\"in_iface\":\"bond0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.5\",\"src_port\":53114,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"metadata\":{\"flowbits\":[\"min.gethttp\",\"http.dottedquadhost\"]},\"community_id\":\"xx\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2843816,\"rev\":1,\"signature\":\"ETPRO HUNTING Generic Inbound URI Directory Traversal\",\"category\":\"Potentially Bad Traffic\",\"severity\":2,\"metadata\":{\"created_at\":[\"2020_08_04\"],\"deployment\":[\"Perimeter\"],\"former_category\":[\"HUNTING\"],\"performance_impact\":[\"Moderate\"],\"signature_severity\":[\"Informational\"],\"updated_at\":[\"2020_08_04\"]},\"rule\":\"alert http any any -> [$HTTP_SERVERS,$HOME_NET] any (msg:\\\"ETPRO HUNTING Generic Inbound URI Directory Traversal\\\"; flow:established,to_server; http.uri; content:\\\"=../\\\"; fast_pattern; classtype:bad-unknown; sid:2843816; rev:1; metadata:created_at 2020_08_04, deployment Perimeter, former_category HUNTING, performance_impact Moderate, signature_severity Informational, updated_at 2020_08_04;)\"},\"app_proto\":\"http\",\"payload_printable\":\"GET /ind.\",\"stream\":1,\"packet\":\"xxx\",\"packet_info\":{\"linktype\":1}}"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][2].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][2].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-11T05:52:18.378379+0000\",\"flow_id\":883709815679084,\"in_iface\":\"eth0\",\"event_type\":\"flow\",\"src_ip\":\"1.2.3.6\",\"src_port\":56814,\"dest_ip\":\"127.0.0.1\",\"dest_port\":2352,\"proto\":\"TCP\",\"flow\":{\"pkts_toserver\":2,\"pkts_toclient\":1,\"bytes_toserver\":108,\"bytes_toclient\":54,\"start\":\"2022-07-11T05:48:21.714860+0000\",\"end\":\"2022-07-11T05:48:21.733121+0000\",\"age\":0,\"state\":\"closed\",\"reason\":\"timeout\",\"alerted\":false},\"tcp\":{\"tcp_flags\":\"16\",\"tcp_flags_ts\":\"06\",\"tcp_flags_tc\":\"14\",\"syn\":true,\"rst\":true,\"ack\":true,\"state\":\"closed\"}}"
results["s00-raw"]["crowdsecurity/non-syslog"][2].Evt.Parsed["program"] == "suricata-evelogs"
results["s00-raw"]["crowdsecurity/non-syslog"][2].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s00-raw"]["crowdsecurity/non-syslog"][2].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][3].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][3].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-11T05:53:51.912203+0000\",\"event_type\":\"stats\",\"stats\":{\"uptime\":510552,\"capture\":{\"kernel_packets\":373404,\"kernel_drops\":0,\"errors\":0},\"decoder\":{\"pkts\":373404,\"bytes\":75476420,\"invalid\":0,\"ipv4\":334023,\"ipv6\":141,\"ethernet\":373404,\"chdlc\":0,\"raw\":0,\"null\":0,\"sll\":0,\"tcp\":244417,\"udp\":86866,\"sctp\":0,\"icmpv4\":2740,\"icmpv6\":141,\"ppp\":0,\"pppoe\":0,\"geneve\":0,\"gre\":0,\"vlan\":0,\"vlan_qinq\":0,\"vxlan\":0,\"vntag\":0,\"ieee8021ah\":0,\"teredo\":0,\"ipv4_in_ipv6\":0,\"ipv6_in_ipv6\":0,\"mpls\":0,\"avg_pkt_size\":202,\"max_pkt_size\":1514,\"max_mac_addrs_src\":0,\"max_mac_addrs_dst\":0,\"erspan\":0,\"event\":{\"ipv4\":{\"pkt_too_small\":0,\"hlen_too_small\":0,\"iplen_smaller_than_hlen\":0,\"trunc_pkt\":0,\"opt_invalid\":0,\"opt_invalid_len\":0,\"opt_malformed\":0,\"opt_pad_required\":0,\"opt_eol_required\":0,\"opt_duplicate\":0,\"opt_unknown\":0,\"wrong_ip_version\":0,\"icmpv6\":0,\"frag_pkt_too_large\":0,\"frag_overlap\":0,\"frag_ignored\":0},\"icmpv4\":{\"pkt_too_small\":0,\"unknown_type\":0,\"unknown_code\":0,\"ipv4_trunc_pkt\":0,\"ipv4_unknown_ver\":0},\"icmpv6\":{\"unknown_type\":0,\"unknown_code\":0,\"pkt_too_small\":0,\"ipv6_unknown_version\":0,\"ipv6_trunc_pkt\":0,\"mld_message_with_invalid_hl\":0,\"unassigned_type\":0,\"experimentation_type\":0},\"ipv6\":{\"pkt_too_small\":0,\"trunc_pkt\":0,\"trunc_exthdr\":0,\"exthdr_dupl_fh\":0,\"exthdr_useless_fh\":0,\"exthdr_dupl_rh\":0,\"exthdr_dupl_hh\":0,\"exthdr_dupl_dh\":0,\"exthdr_dupl_ah\":0,\"exthdr_dupl_eh\":0,\"exthdr_invalid_optlen\":0,\"wrong_ip_version\":0,\"exthdr_ah_res_not_null\":0,\"hopopts_unknown_opt\":0,\"hopopts_only_padding\":0,\"dstopts_unknown_opt\":0,\"dstopts_only_padding\":0,\"rh_type_0\":0,\"zero_len_padn\":0,\"fh_non_zero_reserved_field\":0,\"data_after_none_header\":0,\"unknown_next_header\":0,\"icmpv4\":0,\"frag_pkt_too_large\":0,\"frag_overlap\":0,\"frag_invalid_length\":0,\"frag_ignored\":0,\"ipv4_in_ipv6_too_small\":0,\"ipv4_in_ipv6_wrong_version\":0,\"ipv6_in_ipv6_too_small\":0,\"ipv6_in_ipv6_wrong_version\":0},\"tcp\":{\"pkt_too_small\":0,\"hlen_too_small\":0,\"invalid_optlen\":0,\"opt_invalid_len\":0,\"opt_duplicate\":0},\"udp\":{\"pkt_too_small\":0,\"hlen_too_small\":0,\"hlen_invalid\":0},\"sll\":{\"pkt_too_small\":0},\"ethernet\":{\"pkt_too_small\":0},\"ppp\":{\"pkt_too_small\":0,\"vju_pkt_too_small\":0,\"ip4_pkt_too_small\":0,\"ip6_pkt_too_small\":0,\"wrong_type\":0,\"unsup_proto\":0},\"pppoe\":{\"pkt_too_small\":0,\"wrong_code\":0,\"malformed_tags\":0},\"gre\":{\"pkt_too_small\":0,\"wrong_version\":0,\"version0_recur\":0,\"version0_flags\":0,\"version0_hdr_too_big\":0,\"version0_malformed_sre_hdr\":0,\"version1_chksum\":0,\"version1_route\":0,\"version1_ssr\":0,\"version1_recur\":0,\"version1_flags\":0,\"version1_no_key\":0,\"version1_wrong_protocol\":0,\"version1_malformed_sre_hdr\":0,\"version1_hdr_too_big\":0},\"vlan\":{\"header_too_small\":0,\"unknown_type\":0,\"too_many_layers\":0},\"ieee8021ah\":{\"header_too_small\":0},\"vntag\":{\"header_too_small\":0,\"unknown_type\":0},\"ipraw\":{\"invalid_ip_version\":0},\"ltnull\":{\"pkt_too_small\":0,\"unsupported_type\":0},\"sctp\":{\"pkt_too_small\":0},\"mpls\":{\"header_too_small\":0,\"pkt_too_small\":0,\"bad_label_router_alert\":0,\"bad_label_implicit_null\":0,\"bad_label_reserved\":0,\"unknown_payload_type\":0},\"vxlan\":{\"unknown_payload_type\":0},\"geneve\":{\"unknown_payload_type\":0},\"erspan\":{\"header_too_small\":0,\"unsupported_version\":0,\"too_many_vlan_layers\":0},\"dce\":{\"pkt_too_small\":0},\"chdlc\":{\"pkt_too_small\":0}},\"too_many_layers\":0},\"flow\":{\"memcap\":0,\"tcp\":59557,\"udp\":44825,\"icmpv4\":0,\"icmpv6\":141,\"tcp_reuse\":3,\"get_used\":0,\"get_used_eval\":0,\"get_used_eval_reject\":0,\"get_used_eval_busy\":0,\"get_used_failed\":0,\"wrk\":{\"spare_sync_avg\":100,\"spare_sync\":1038,\"spare_sync_incomplete\":0,\"spare_sync_empty\":0,\"flows_evicted_needs_work\":750,\"flows_evicted_pkt_inject\":1319,\"flows_evicted\":101,\"flows_injected\":749},\"mgr\":{\"full_hash_pass\":2128,\"closed_pruned\":0,\"new_pruned\":0,\"est_pruned\":0,\"bypassed_pruned\":0,\"rows_maxlen\":3,\"flows_checked\":162128,\"flows_notimeout\":57784,\"flows_timeout\":104344,\"flows_timeout_inuse\":0,\"flows_evicted\":104357,\"flows_evicted_needs_work\":749},\"spare\":9808,\"emerg_mode_entered\":0,\"emerg_mode_over\":0,\"memuse\":7474304},\"defrag\":{\"ipv4\":{\"fragments\":0,\"reassembled\":0,\"timeouts\":0},\"ipv6\":{\"fragments\":0,\"reassembled\":0,\"timeouts\":0},\"max_frag_hits\":0},\"flow_bypassed\":{\"local_pkts\":0,\"local_bytes\":0,\"local_capture_pkts\":0,\"local_capture_bytes\":0,\"closed\":0,\"pkts\":0,\"bytes\":0},\"tcp\":{\"sessions\":58614,\"ssn_memcap_drop\":0,\"pseudo\":0,\"pseudo_failed\":0,\"invalid_checksum\":253,\"no_flow\":0,\"syn\":59963,\"synack\":8969,\"rst\":79692,\"midstream_pickups\":0,\"pkt_on_wrong_thread\":0,\"segment_memcap_drop\":0,\"stream_depth_reached\":3,\"reassembly_gap\":0,\"overlap\":106,\"overlap_diff_data\":0,\"insert_data_normal_fail\":0,\"insert_data_overlap_fail\":0,\"insert_list_fail\":0,\"memuse\":1212416,\"reassembly_memuse\":196608},\"detect\":{\"engines\":[{\"id\":0,\"last_reload\":\"2022-07-05T08:03:10.331430+0000\",\"rules_loaded\":25206,\"rules_failed\":24}],\"alert\":2476},\"app_layer\":{\"flow\":{\"http\":1361,\"ftp\":0,\"smtp\":0,\"tls\":82,\"ssh\":920,\"imap\":0,\"smb\":0,\"dcerpc_tcp\":0,\"dns_tcp\":0,\"nfs_tcp\":0,\"ntp\":41804,\"ftp-data\":0,\"tftp\":16,\"ikev2\":0,\"krb5_tcp\":0,\"dhcp\":284,\"snmp\":82,\"sip\":294,\"rfb\":0,\"mqtt\":0,\"rdp\":0,\"failed_tcp\":0,\"dcerpc_udp\":0,\"dns_udp\":292,\"nfs_udp\":0,\"krb5_udp\":0,\"failed_udp\":2053},\"tx\":{\"http\":1444,\"ftp\":0,\"smtp\":0,\"tls\":0,\"ssh\":0,\"imap\":0,\"smb\":0,\"dcerpc_tcp\":0,\"dns_tcp\":0,\"nfs_tcp\":0,\"ntp\":41818,\"ftp-data\":0,\"tftp\":16,\"ikev2\":0,\"krb5_tcp\":0,\"dhcp\":568,\"snmp\":86,\"sip\":294,\"rfb\":0,\"mqtt\":0,\"rdp\":0,\"dcerpc_udp\":0,\"dns_udp\":507,\"nfs_udp\":0,\"krb5_udp\":0},\"expectations\":0},\"http\":{\"memuse\":0,\"memcap\":0},\"ftp\":{\"memuse\":0,\"memcap\":0},\"file_store\":{\"open_files\":0}}}"
results["s00-raw"]["crowdsecurity/non-syslog"][3].Evt.Parsed["program"] == "suricata-evelogs"
results["s00-raw"]["crowdsecurity/non-syslog"][3].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s00-raw"]["crowdsecurity/non-syslog"][3].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][4].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][4].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-11T06:09:52.602489+0000\",\"flow_id\":1684596746908921,\"in_iface\":\"eth0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.7\",\"src_port\":36288,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2034125,\"rev\":4,\"signature\":\"ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2\",\"category\":\"Attempted Administrator Privilege Gain\",\"severity\":1,\"metadata\":{\"affected_product\":[\"Apache_HTTP_server\"],\"attack_target\":[\"Web_Server\"],\"created_at\":[\"2021_10_05\"],\"cve\":[\"CVE_2021_41773\"],\"deployment\":[\"Internet\",\"Perimeter\"],\"former_category\":[\"EXPLOIT\"],\"performance_impact\":[\"Low\"],\"signature_severity\":[\"Major\"],\"updated_at\":[\"2022_04_18\"]}},\"http\":{\"hostname\":\"34.245.178.108\",\"http_port\":80,\"url\":\"/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh\",\"http_user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\",\"http_content_type\":\"text/html\",\"http_method\":\"POST\",\"protocol\":\"HTTP/1.1\",\"status\":400,\"length\":166,\"http_request_body\":\"QT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"http_response_body\":\"PGh0bWw+DQo8aGVhZD48dGl0bGU+NDAwIEJhZCBSZXF1ZXN0PC90aXRsZT48L2hlYWQ+DQo8Ym9keT4NCjxjZW50ZXI+PGgxPjQwMCBCYWQgUmVxdWVzdDwvaDE+PC9jZW50ZXI+DQo8aHI+PGNlbnRlcj5uZ2lueC8xLjE4LjAgKFVidW50dSk8L2NlbnRlcj4NCjwvYm9keT4NCjwvaHRtbD4NCg==\"},\"files\":[{\"filename\":\"/bin/sh\",\"sid\":[],\"gaps\":false,\"state\":\"CLOSED\",\"stored\":false,\"size\":33,\"tx_id\":0}],\"app_proto\":\"http\",\"flow\":{\"pkts_toserver\":4,\"pkts_toclient\":4,\"bytes_toserver\":623,\"bytes_toclient\":599,\"start\":\"2022-07-11T06:09:52.488697+0000\"},\"payload\":\"UE9TVCAvY2dpLWJpbi8uJTJlLy4lMmUvLiUyZS8uJTJlL2Jpbi9zaCBIVFRQLzEuMQ0KSG9zdDogMzQuMjQ1LjE3OC4xMDg6ODANClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS83OC4wLjM5MDQuMTA4IFNhZmFyaS81MzcuMzYNCkNvbnRlbnQtTGVuZ3RoOiAzMw0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCkFjY2VwdC1FbmNvZGluZzogZ3ppcA0KQ29ubmVjdGlvbjogY2xvc2UNCg0KQT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"stream\":1}"
results["s00-raw"]["crowdsecurity/non-syslog"][4].Evt.Parsed["program"] == "suricata-evelogs"
results["s00-raw"]["crowdsecurity/non-syslog"][4].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s00-raw"]["crowdsecurity/non-syslog"][4].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][5].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][5].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-12T05:52:18.378379-0000\",\"flow_id\":883709815679084,\"in_iface\":\"eth0\",\"event_type\":\"flow\",\"src_ip\":\"1.2.3.6\",\"src_port\":56814,\"dest_ip\":\"127.0.0.1\",\"dest_port\":2352,\"proto\":\"TCP\",\"flow\":{\"pkts_toserver\":2,\"pkts_toclient\":1,\"bytes_toserver\":108,\"bytes_toclient\":54,\"start\":\"2022-07-12T05:48:21.714860-0000\",\"end\":\"2022-07-11T05:48:21.733121+0000\",\"age\":0,\"state\":\"closed\",\"reason\":\"timeout\",\"alerted\":false},\"tcp\":{\"tcp_flags\":\"16\",\"tcp_flags_ts\":\"06\",\"tcp_flags_tc\":\"14\",\"syn\":true,\"rst\":true,\"ack\":true,\"state\":\"closed\"}}"
results["s00-raw"]["crowdsecurity/non-syslog"][5].Evt.Parsed["program"] == "suricata-evelogs"
results["s00-raw"]["crowdsecurity/non-syslog"][5].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s00-raw"]["crowdsecurity/non-syslog"][5].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][6].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][6].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-12T05:53:51.912203-0000\",\"event_type\":\"stats\",\"stats\":{\"uptime\":510552,\"capture\":{\"kernel_packets\":373404,\"kernel_drops\":0,\"errors\":0},\"decoder\":{\"pkts\":373404,\"bytes\":75476420,\"invalid\":0,\"ipv4\":334023,\"ipv6\":141,\"ethernet\":373404,\"chdlc\":0,\"raw\":0,\"null\":0,\"sll\":0,\"tcp\":244417,\"udp\":86866,\"sctp\":0,\"icmpv4\":2740,\"icmpv6\":141,\"ppp\":0,\"pppoe\":0,\"geneve\":0,\"gre\":0,\"vlan\":0,\"vlan_qinq\":0,\"vxlan\":0,\"vntag\":0,\"ieee8021ah\":0,\"teredo\":0,\"ipv4_in_ipv6\":0,\"ipv6_in_ipv6\":0,\"mpls\":0,\"avg_pkt_size\":202,\"max_pkt_size\":1514,\"max_mac_addrs_src\":0,\"max_mac_addrs_dst\":0,\"erspan\":0,\"event\":{\"ipv4\":{\"pkt_too_small\":0,\"hlen_too_small\":0,\"iplen_smaller_than_hlen\":0,\"trunc_pkt\":0,\"opt_invalid\":0,\"opt_invalid_len\":0,\"opt_malformed\":0,\"opt_pad_required\":0,\"opt_eol_required\":0,\"opt_duplicate\":0,\"opt_unknown\":0,\"wrong_ip_version\":0,\"icmpv6\":0,\"frag_pkt_too_large\":0,\"frag_overlap\":0,\"frag_ignored\":0},\"icmpv4\":{\"pkt_too_small\":0,\"unknown_type\":0,\"unknown_code\":0,\"ipv4_trunc_pkt\":0,\"ipv4_unknown_ver\":0},\"icmpv6\":{\"unknown_type\":0,\"unknown_code\":0,\"pkt_too_small\":0,\"ipv6_unknown_version\":0,\"ipv6_trunc_pkt\":0,\"mld_message_with_invalid_hl\":0,\"unassigned_type\":0,\"experimentation_type\":0},\"ipv6\":{\"pkt_too_small\":0,\"trunc_pkt\":0,\"trunc_exthdr\":0,\"exthdr_dupl_fh\":0,\"exthdr_useless_fh\":0,\"exthdr_dupl_rh\":0,\"exthdr_dupl_hh\":0,\"exthdr_dupl_dh\":0,\"exthdr_dupl_ah\":0,\"exthdr_dupl_eh\":0,\"exthdr_invalid_optlen\":0,\"wrong_ip_version\":0,\"exthdr_ah_res_not_null\":0,\"hopopts_unknown_opt\":0,\"hopopts_only_padding\":0,\"dstopts_unknown_opt\":0,\"dstopts_only_padding\":0,\"rh_type_0\":0,\"zero_len_padn\":0,\"fh_non_zero_reserved_field\":0,\"data_after_none_header\":0,\"unknown_next_header\":0,\"icmpv4\":0,\"frag_pkt_too_large\":0,\"frag_overlap\":0,\"frag_invalid_length\":0,\"frag_ignored\":0,\"ipv4_in_ipv6_too_small\":0,\"ipv4_in_ipv6_wrong_version\":0,\"ipv6_in_ipv6_too_small\":0,\"ipv6_in_ipv6_wrong_version\":0},\"tcp\":{\"pkt_too_small\":0,\"hlen_too_small\":0,\"invalid_optlen\":0,\"opt_invalid_len\":0,\"opt_duplicate\":0},\"udp\":{\"pkt_too_small\":0,\"hlen_too_small\":0,\"hlen_invalid\":0},\"sll\":{\"pkt_too_small\":0},\"ethernet\":{\"pkt_too_small\":0},\"ppp\":{\"pkt_too_small\":0,\"vju_pkt_too_small\":0,\"ip4_pkt_too_small\":0,\"ip6_pkt_too_small\":0,\"wrong_type\":0,\"unsup_proto\":0},\"pppoe\":{\"pkt_too_small\":0,\"wrong_code\":0,\"malformed_tags\":0},\"gre\":{\"pkt_too_small\":0,\"wrong_version\":0,\"version0_recur\":0,\"version0_flags\":0,\"version0_hdr_too_big\":0,\"version0_malformed_sre_hdr\":0,\"version1_chksum\":0,\"version1_route\":0,\"version1_ssr\":0,\"version1_recur\":0,\"version1_flags\":0,\"version1_no_key\":0,\"version1_wrong_protocol\":0,\"version1_malformed_sre_hdr\":0,\"version1_hdr_too_big\":0},\"vlan\":{\"header_too_small\":0,\"unknown_type\":0,\"too_many_layers\":0},\"ieee8021ah\":{\"header_too_small\":0},\"vntag\":{\"header_too_small\":0,\"unknown_type\":0},\"ipraw\":{\"invalid_ip_version\":0},\"ltnull\":{\"pkt_too_small\":0,\"unsupported_type\":0},\"sctp\":{\"pkt_too_small\":0},\"mpls\":{\"header_too_small\":0,\"pkt_too_small\":0,\"bad_label_router_alert\":0,\"bad_label_implicit_null\":0,\"bad_label_reserved\":0,\"unknown_payload_type\":0},\"vxlan\":{\"unknown_payload_type\":0},\"geneve\":{\"unknown_payload_type\":0},\"erspan\":{\"header_too_small\":0,\"unsupported_version\":0,\"too_many_vlan_layers\":0},\"dce\":{\"pkt_too_small\":0},\"chdlc\":{\"pkt_too_small\":0}},\"too_many_layers\":0},\"flow\":{\"memcap\":0,\"tcp\":59557,\"udp\":44825,\"icmpv4\":0,\"icmpv6\":141,\"tcp_reuse\":3,\"get_used\":0,\"get_used_eval\":0,\"get_used_eval_reject\":0,\"get_used_eval_busy\":0,\"get_used_failed\":0,\"wrk\":{\"spare_sync_avg\":100,\"spare_sync\":1038,\"spare_sync_incomplete\":0,\"spare_sync_empty\":0,\"flows_evicted_needs_work\":750,\"flows_evicted_pkt_inject\":1319,\"flows_evicted\":101,\"flows_injected\":749},\"mgr\":{\"full_hash_pass\":2128,\"closed_pruned\":0,\"new_pruned\":0,\"est_pruned\":0,\"bypassed_pruned\":0,\"rows_maxlen\":3,\"flows_checked\":162128,\"flows_notimeout\":57784,\"flows_timeout\":104344,\"flows_timeout_inuse\":0,\"flows_evicted\":104357,\"flows_evicted_needs_work\":749},\"spare\":9808,\"emerg_mode_entered\":0,\"emerg_mode_over\":0,\"memuse\":7474304},\"defrag\":{\"ipv4\":{\"fragments\":0,\"reassembled\":0,\"timeouts\":0},\"ipv6\":{\"fragments\":0,\"reassembled\":0,\"timeouts\":0},\"max_frag_hits\":0},\"flow_bypassed\":{\"local_pkts\":0,\"local_bytes\":0,\"local_capture_pkts\":0,\"local_capture_bytes\":0,\"closed\":0,\"pkts\":0,\"bytes\":0},\"tcp\":{\"sessions\":58614,\"ssn_memcap_drop\":0,\"pseudo\":0,\"pseudo_failed\":0,\"invalid_checksum\":253,\"no_flow\":0,\"syn\":59963,\"synack\":8969,\"rst\":79692,\"midstream_pickups\":0,\"pkt_on_wrong_thread\":0,\"segment_memcap_drop\":0,\"stream_depth_reached\":3,\"reassembly_gap\":0,\"overlap\":106,\"overlap_diff_data\":0,\"insert_data_normal_fail\":0,\"insert_data_overlap_fail\":0,\"insert_list_fail\":0,\"memuse\":1212416,\"reassembly_memuse\":196608},\"detect\":{\"engines\":[{\"id\":0,\"last_reload\":\"2022-07-05T08:03:10.331430+0000\",\"rules_loaded\":25206,\"rules_failed\":24}],\"alert\":2476},\"app_layer\":{\"flow\":{\"http\":1361,\"ftp\":0,\"smtp\":0,\"tls\":82,\"ssh\":920,\"imap\":0,\"smb\":0,\"dcerpc_tcp\":0,\"dns_tcp\":0,\"nfs_tcp\":0,\"ntp\":41804,\"ftp-data\":0,\"tftp\":16,\"ikev2\":0,\"krb5_tcp\":0,\"dhcp\":284,\"snmp\":82,\"sip\":294,\"rfb\":0,\"mqtt\":0,\"rdp\":0,\"failed_tcp\":0,\"dcerpc_udp\":0,\"dns_udp\":292,\"nfs_udp\":0,\"krb5_udp\":0,\"failed_udp\":2053},\"tx\":{\"http\":1444,\"ftp\":0,\"smtp\":0,\"tls\":0,\"ssh\":0,\"imap\":0,\"smb\":0,\"dcerpc_tcp\":0,\"dns_tcp\":0,\"nfs_tcp\":0,\"ntp\":41818,\"ftp-data\":0,\"tftp\":16,\"ikev2\":0,\"krb5_tcp\":0,\"dhcp\":568,\"snmp\":86,\"sip\":294,\"rfb\":0,\"mqtt\":0,\"rdp\":0,\"dcerpc_udp\":0,\"dns_udp\":507,\"nfs_udp\":0,\"krb5_udp\":0},\"expectations\":0},\"http\":{\"memuse\":0,\"memcap\":0},\"ftp\":{\"memuse\":0,\"memcap\":0},\"file_store\":{\"open_files\":0}}}"
results["s00-raw"]["crowdsecurity/non-syslog"][6].Evt.Parsed["program"] == "suricata-evelogs"
results["s00-raw"]["crowdsecurity/non-syslog"][6].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][6].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s00-raw"]["crowdsecurity/non-syslog"][7].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][7].Evt.Parsed["program"] == "suricata-evelogs"
results["s00-raw"]["crowdsecurity/non-syslog"][7].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-12T06:09:52.602489-0000\",\"flow_id\":1684596746908921,\"in_iface\":\"eth0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.7\",\"src_port\":36288,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2034125,\"rev\":4,\"signature\":\"ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2\",\"category\":\"Attempted Administrator Privilege Gain\",\"severity\":1,\"metadata\":{\"affected_product\":[\"Apache_HTTP_server\"],\"attack_target\":[\"Web_Server\"],\"created_at\":[\"2021_10_05\"],\"cve\":[\"CVE_2021_41773\"],\"deployment\":[\"Internet\",\"Perimeter\"],\"former_category\":[\"EXPLOIT\"],\"performance_impact\":[\"Low\"],\"signature_severity\":[\"Major\"],\"updated_at\":[\"2022_04_18\"]}},\"http\":{\"hostname\":\"34.245.178.108\",\"http_port\":80,\"url\":\"/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh\",\"http_user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\",\"http_content_type\":\"text/html\",\"http_method\":\"POST\",\"protocol\":\"HTTP/1.1\",\"status\":400,\"length\":166,\"http_request_body\":\"QT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"http_response_body\":\"PGh0bWw+DQo8aGVhZD48dGl0bGU+NDAwIEJhZCBSZXF1ZXN0PC90aXRsZT48L2hlYWQ+DQo8Ym9keT4NCjxjZW50ZXI+PGgxPjQwMCBCYWQgUmVxdWVzdDwvaDE+PC9jZW50ZXI+DQo8aHI+PGNlbnRlcj5uZ2lueC8xLjE4LjAgKFVidW50dSk8L2NlbnRlcj4NCjwvYm9keT4NCjwvaHRtbD4NCg==\"},\"files\":[{\"filename\":\"/bin/sh\",\"sid\":[],\"gaps\":false,\"state\":\"CLOSED\",\"stored\":false,\"size\":33,\"tx_id\":0}],\"app_proto\":\"http\",\"flow\":{\"pkts_toserver\":4,\"pkts_toclient\":4,\"bytes_toserver\":623,\"bytes_toclient\":599,\"start\":\"2022-07-12T06:09:52.488697-0000\"},\"payload\":\"UE9TVCAvY2dpLWJpbi8uJTJlLy4lMmUvLiUyZS8uJTJlL2Jpbi9zaCBIVFRQLzEuMQ0KSG9zdDogMzQuMjQ1LjE3OC4xMDg6ODANClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS83OC4wLjM5MDQuMTA4IFNhZmFyaS81MzcuMzYNCkNvbnRlbnQtTGVuZ3RoOiAzMw0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCkFjY2VwdC1FbmNvZGluZzogZ3ppcA0KQ29ubmVjdGlvbjogY2xvc2UNCg0KQT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"stream\":1}"
results["s00-raw"]["crowdsecurity/non-syslog"][7].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][7].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
len(results["s00-raw"]["crowdsecurity/syslog-logs"]) == 8
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Success == false
results["s00-raw"]["crowdsecurity/syslog-logs"][1].Success == false
results["s00-raw"]["crowdsecurity/syslog-logs"][2].Success == false
results["s00-raw"]["crowdsecurity/syslog-logs"][3].Success == false
results["s00-raw"]["crowdsecurity/syslog-logs"][4].Success == false
results["s00-raw"]["crowdsecurity/syslog-logs"][5].Success == false
results["s00-raw"]["crowdsecurity/syslog-logs"][6].Success == false
results["s00-raw"]["crowdsecurity/syslog-logs"][7].Success == false
len(results["s01-parse"]["crowdsecurity/suricata-evelogs"]) == 8
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Success == true
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Parsed["suricata_alert_signature_rev"] == "3"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Parsed["time"] == "2022-07-10T23:50:05.533101"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Parsed["dest_ip"] == "127.0.0.1"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Parsed["dest_port"] == "80"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-10T23:50:05.533101+0000\",\"flow_id\":1258832998001901,\"in_iface\":\"bond0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.4\",\"src_port\":52812,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"metadata\":{\"flowbits\":[\"ET.formdata\",\"http.dottedquadhost\"]},\"community_id\":\"xx\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2024468,\"rev\":3,\"signature\":\"ET WEB_SPECIFIC_APPS OGNL Expression Injection (CVE-2017-9791)\",\"category\":\"Attempted User Privilege Gain\",\"severity\":1,\"metadata\":{\"affected_product\":[\"Apache_Struts2\"],\"attack_target\":[\"Web_Server\"],\"created_at\":[\"2017_07_14\"],\"deployment\":[\"Datacenter\"],\"former_category\":[\"WEB_SPECIFIC_APPS\"],\"performance_impact\":[\"Low\"],\"signature_severity\":[\"Major\"],\"updated_at\":[\"2020_08_10\"]},\"rule\":\"alert http any any -> $HTTP_SERVERS any (msg:\\\"ET WEB_SPECIFIC_APPS OGNL Expression Injection (CVE-2017-9791)\\\"; flow:established,to_server; http.method; content:\\\"POST\\\"; nocase; http.request_body; content:\\\"multipart\\\"; content:\\\"form-data\\\"; distance:1; within:11; content:\\\"ognl.OgnlContext\\\"; distance:1; fast_pattern; content:\\\"DEFAULT_MEMBER_ACCESS\\\"; distance:1; within:23; content:\\\"java.lang.ProcessBuilder\\\"; distance:1; content:\\\".start\\\"; distance:1; reference:url,securityonline.info/tutorial-cve-2017-9791-apache-struts2-s2-048-remote-code-execution-vulnerability/; reference:cve,2017-9791; classtype:attempted-user; sid:2024468; rev:3; metadata:affected_product Apache_Struts2, attack_target Web_Server, created_at 2017_07_14, deployment Datacenter, former_category WEB_SPECIFIC_APPS, performance_impact Low, signature_severity Major, updated_at 2020_08_10;)\"},\"files\":[{\"filename\":\"%{0b\",\"sid\":[],\"gaps\":false,\"state\":\"CLOSED\",\"stored\":false,\"size\":1,\"tx_id\":0}],\"app_proto\":\"http\",\"payload_printable\":\"POST /ind\\n\",\"stream\":1,\"packet\":\"xxx\",\"packet_info\":{\"linktype\":1}}"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Parsed["program"] == "suricata-evelogs"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Parsed["proto"] == "TCP"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Parsed["suricata_alert_signature"] == "ET WEB_SPECIFIC_APPS OGNL Expression Injection (CVE-2017-9791)"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Meta["suricata_alert_signature_id"] == "2024468"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Meta["datasource_type"] == "file"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Meta["source_ip"] == "1.2.3.4"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Meta["sub_log_type"] == "suricata_alert_eve_json"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Meta["log_type"] == "suricata_alert"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Meta["service"] == "suricata"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Meta["suricata_flow_id"] == "1258832998001901"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][0].Evt.Meta["suricata_rule_severity"] == "1"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Success == true
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Parsed["program"] == "suricata-evelogs"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Parsed["proto"] == "TCP"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Parsed["suricata_alert_signature"] == "ETPRO HUNTING Generic Inbound URI Directory Traversal"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Parsed["suricata_alert_signature_rev"] == "1"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Parsed["time"] == "2022-07-10T23:52:31.097119"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Parsed["dest_ip"] == "127.0.0.1"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Parsed["dest_port"] == "80"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-10T23:52:31.097119+0000\",\"flow_id\":836311304881252,\"in_iface\":\"bond0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.5\",\"src_port\":53114,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"metadata\":{\"flowbits\":[\"min.gethttp\",\"http.dottedquadhost\"]},\"community_id\":\"xx\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2843816,\"rev\":1,\"signature\":\"ETPRO HUNTING Generic Inbound URI Directory Traversal\",\"category\":\"Potentially Bad Traffic\",\"severity\":2,\"metadata\":{\"created_at\":[\"2020_08_04\"],\"deployment\":[\"Perimeter\"],\"former_category\":[\"HUNTING\"],\"performance_impact\":[\"Moderate\"],\"signature_severity\":[\"Informational\"],\"updated_at\":[\"2020_08_04\"]},\"rule\":\"alert http any any -> [$HTTP_SERVERS,$HOME_NET] any (msg:\\\"ETPRO HUNTING Generic Inbound URI Directory Traversal\\\"; flow:established,to_server; http.uri; content:\\\"=../\\\"; fast_pattern; classtype:bad-unknown; sid:2843816; rev:1; metadata:created_at 2020_08_04, deployment Perimeter, former_category HUNTING, performance_impact Moderate, signature_severity Informational, updated_at 2020_08_04;)\"},\"app_proto\":\"http\",\"payload_printable\":\"GET /ind.\",\"stream\":1,\"packet\":\"xxx\",\"packet_info\":{\"linktype\":1}}"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Meta["datasource_type"] == "file"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Meta["suricata_rule_severity"] == "2"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Meta["log_type"] == "suricata_alert"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Meta["service"] == "suricata"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Meta["source_ip"] == "1.2.3.5"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Meta["sub_log_type"] == "suricata_alert_eve_json"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Meta["suricata_alert_signature_id"] == "2843816"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][1].Evt.Meta["suricata_flow_id"] == "836311304881252"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][2].Success == false
results["s01-parse"]["crowdsecurity/suricata-evelogs"][3].Success == false
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Success == true
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Parsed["dest_ip"] == "127.0.0.1"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Parsed["dest_port"] == "80"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-11T06:09:52.602489+0000\",\"flow_id\":1684596746908921,\"in_iface\":\"eth0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.7\",\"src_port\":36288,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2034125,\"rev\":4,\"signature\":\"ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2\",\"category\":\"Attempted Administrator Privilege Gain\",\"severity\":1,\"metadata\":{\"affected_product\":[\"Apache_HTTP_server\"],\"attack_target\":[\"Web_Server\"],\"created_at\":[\"2021_10_05\"],\"cve\":[\"CVE_2021_41773\"],\"deployment\":[\"Internet\",\"Perimeter\"],\"former_category\":[\"EXPLOIT\"],\"performance_impact\":[\"Low\"],\"signature_severity\":[\"Major\"],\"updated_at\":[\"2022_04_18\"]}},\"http\":{\"hostname\":\"34.245.178.108\",\"http_port\":80,\"url\":\"/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh\",\"http_user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\",\"http_content_type\":\"text/html\",\"http_method\":\"POST\",\"protocol\":\"HTTP/1.1\",\"status\":400,\"length\":166,\"http_request_body\":\"QT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"http_response_body\":\"PGh0bWw+DQo8aGVhZD48dGl0bGU+NDAwIEJhZCBSZXF1ZXN0PC90aXRsZT48L2hlYWQ+DQo8Ym9keT4NCjxjZW50ZXI+PGgxPjQwMCBCYWQgUmVxdWVzdDwvaDE+PC9jZW50ZXI+DQo8aHI+PGNlbnRlcj5uZ2lueC8xLjE4LjAgKFVidW50dSk8L2NlbnRlcj4NCjwvYm9keT4NCjwvaHRtbD4NCg==\"},\"files\":[{\"filename\":\"/bin/sh\",\"sid\":[],\"gaps\":false,\"state\":\"CLOSED\",\"stored\":false,\"size\":33,\"tx_id\":0}],\"app_proto\":\"http\",\"flow\":{\"pkts_toserver\":4,\"pkts_toclient\":4,\"bytes_toserver\":623,\"bytes_toclient\":599,\"start\":\"2022-07-11T06:09:52.488697+0000\"},\"payload\":\"UE9TVCAvY2dpLWJpbi8uJTJlLy4lMmUvLiUyZS8uJTJlL2Jpbi9zaCBIVFRQLzEuMQ0KSG9zdDogMzQuMjQ1LjE3OC4xMDg6ODANClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS83OC4wLjM5MDQuMTA4IFNhZmFyaS81MzcuMzYNCkNvbnRlbnQtTGVuZ3RoOiAzMw0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCkFjY2VwdC1FbmNvZGluZzogZ3ppcA0KQ29ubmVjdGlvbjogY2xvc2UNCg0KQT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"stream\":1}"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Parsed["program"] == "suricata-evelogs"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Parsed["proto"] == "TCP"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Parsed["suricata_alert_signature"] == "ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Parsed["suricata_alert_signature_rev"] == "4"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Parsed["time"] == "2022-07-11T06:09:52.602489"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Meta["sub_log_type"] == "suricata_alert_eve_json"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Meta["datasource_type"] == "file"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Meta["service"] == "suricata"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Meta["source_ip"] == "1.2.3.7"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Meta["log_type"] == "suricata_alert"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Meta["suricata_alert_signature_id"] == "2034125"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Meta["suricata_flow_id"] == "1684596746908921"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][4].Evt.Meta["suricata_rule_severity"] == "1"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][5].Success == false
results["s01-parse"]["crowdsecurity/suricata-evelogs"][6].Success == false
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Success == true
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Parsed["time"] == "2022-07-12T06:09:52.602489"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Parsed["dest_ip"] == "127.0.0.1"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Parsed["dest_port"] == "80"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-12T06:09:52.602489-0000\",\"flow_id\":1684596746908921,\"in_iface\":\"eth0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.7\",\"src_port\":36288,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2034125,\"rev\":4,\"signature\":\"ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2\",\"category\":\"Attempted Administrator Privilege Gain\",\"severity\":1,\"metadata\":{\"affected_product\":[\"Apache_HTTP_server\"],\"attack_target\":[\"Web_Server\"],\"created_at\":[\"2021_10_05\"],\"cve\":[\"CVE_2021_41773\"],\"deployment\":[\"Internet\",\"Perimeter\"],\"former_category\":[\"EXPLOIT\"],\"performance_impact\":[\"Low\"],\"signature_severity\":[\"Major\"],\"updated_at\":[\"2022_04_18\"]}},\"http\":{\"hostname\":\"34.245.178.108\",\"http_port\":80,\"url\":\"/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh\",\"http_user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\",\"http_content_type\":\"text/html\",\"http_method\":\"POST\",\"protocol\":\"HTTP/1.1\",\"status\":400,\"length\":166,\"http_request_body\":\"QT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"http_response_body\":\"PGh0bWw+DQo8aGVhZD48dGl0bGU+NDAwIEJhZCBSZXF1ZXN0PC90aXRsZT48L2hlYWQ+DQo8Ym9keT4NCjxjZW50ZXI+PGgxPjQwMCBCYWQgUmVxdWVzdDwvaDE+PC9jZW50ZXI+DQo8aHI+PGNlbnRlcj5uZ2lueC8xLjE4LjAgKFVidW50dSk8L2NlbnRlcj4NCjwvYm9keT4NCjwvaHRtbD4NCg==\"},\"files\":[{\"filename\":\"/bin/sh\",\"sid\":[],\"gaps\":false,\"state\":\"CLOSED\",\"stored\":false,\"size\":33,\"tx_id\":0}],\"app_proto\":\"http\",\"flow\":{\"pkts_toserver\":4,\"pkts_toclient\":4,\"bytes_toserver\":623,\"bytes_toclient\":599,\"start\":\"2022-07-12T06:09:52.488697-0000\"},\"payload\":\"UE9TVCAvY2dpLWJpbi8uJTJlLy4lMmUvLiUyZS8uJTJlL2Jpbi9zaCBIVFRQLzEuMQ0KSG9zdDogMzQuMjQ1LjE3OC4xMDg6ODANClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS83OC4wLjM5MDQuMTA4IFNhZmFyaS81MzcuMzYNCkNvbnRlbnQtTGVuZ3RoOiAzMw0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCkFjY2VwdC1FbmNvZGluZzogZ3ppcA0KQ29ubmVjdGlvbjogY2xvc2UNCg0KQT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"stream\":1}"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Parsed["program"] == "suricata-evelogs"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Parsed["proto"] == "TCP"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Parsed["suricata_alert_signature"] == "ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Parsed["suricata_alert_signature_rev"] == "4"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Meta["log_type"] == "suricata_alert"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Meta["source_ip"] == "1.2.3.7"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Meta["sub_log_type"] == "suricata_alert_eve_json"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Meta["suricata_flow_id"] == "1684596746908921"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Meta["datasource_type"] == "file"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Meta["service"] == "suricata"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Meta["suricata_alert_signature_id"] == "2034125"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Meta["suricata_rule_severity"] == "1"
results["s01-parse"]["crowdsecurity/suricata-evelogs"][7].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
len(results["s01-parse"]["crowdsecurity/suricata-fastlogs"]) == 8
results["s01-parse"]["crowdsecurity/suricata-fastlogs"][0].Success == false
results["s01-parse"]["crowdsecurity/suricata-fastlogs"][1].Success == false
results["s01-parse"]["crowdsecurity/suricata-fastlogs"][2].Success == false
results["s01-parse"]["crowdsecurity/suricata-fastlogs"][3].Success == false
results["s01-parse"]["crowdsecurity/suricata-fastlogs"][4].Success == false
results["s01-parse"]["crowdsecurity/suricata-fastlogs"][5].Success == false
results["s01-parse"]["crowdsecurity/suricata-fastlogs"][6].Success == false
results["s01-parse"]["crowdsecurity/suricata-fastlogs"][7].Success == false
len(results["s02-enrich"]["crowdsecurity/dateparse-enrich"]) == 4
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Success == true
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["time"] == "2022-07-10T23:50:05.533101"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["dest_ip"] == "127.0.0.1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["dest_port"] == "80"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-10T23:50:05.533101+0000\",\"flow_id\":1258832998001901,\"in_iface\":\"bond0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.4\",\"src_port\":52812,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"metadata\":{\"flowbits\":[\"ET.formdata\",\"http.dottedquadhost\"]},\"community_id\":\"xx\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2024468,\"rev\":3,\"signature\":\"ET WEB_SPECIFIC_APPS OGNL Expression Injection (CVE-2017-9791)\",\"category\":\"Attempted User Privilege Gain\",\"severity\":1,\"metadata\":{\"affected_product\":[\"Apache_Struts2\"],\"attack_target\":[\"Web_Server\"],\"created_at\":[\"2017_07_14\"],\"deployment\":[\"Datacenter\"],\"former_category\":[\"WEB_SPECIFIC_APPS\"],\"performance_impact\":[\"Low\"],\"signature_severity\":[\"Major\"],\"updated_at\":[\"2020_08_10\"]},\"rule\":\"alert http any any -> $HTTP_SERVERS any (msg:\\\"ET WEB_SPECIFIC_APPS OGNL Expression Injection (CVE-2017-9791)\\\"; flow:established,to_server; http.method; content:\\\"POST\\\"; nocase; http.request_body; content:\\\"multipart\\\"; content:\\\"form-data\\\"; distance:1; within:11; content:\\\"ognl.OgnlContext\\\"; distance:1; fast_pattern; content:\\\"DEFAULT_MEMBER_ACCESS\\\"; distance:1; within:23; content:\\\"java.lang.ProcessBuilder\\\"; distance:1; content:\\\".start\\\"; distance:1; reference:url,securityonline.info/tutorial-cve-2017-9791-apache-struts2-s2-048-remote-code-execution-vulnerability/; reference:cve,2017-9791; classtype:attempted-user; sid:2024468; rev:3; metadata:affected_product Apache_Struts2, attack_target Web_Server, created_at 2017_07_14, deployment Datacenter, former_category WEB_SPECIFIC_APPS, performance_impact Low, signature_severity Major, updated_at 2020_08_10;)\"},\"files\":[{\"filename\":\"%{0b\",\"sid\":[],\"gaps\":false,\"state\":\"CLOSED\",\"stored\":false,\"size\":1,\"tx_id\":0}],\"app_proto\":\"http\",\"payload_printable\":\"POST /ind\\n\",\"stream\":1,\"packet\":\"xxx\",\"packet_info\":{\"linktype\":1}}"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["program"] == "suricata-evelogs"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["proto"] == "TCP"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["suricata_alert_signature"] == "ET WEB_SPECIFIC_APPS OGNL Expression Injection (CVE-2017-9791)"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["suricata_alert_signature_rev"] == "3"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["log_type"] == "suricata_alert"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["service"] == "suricata"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["sub_log_type"] == "suricata_alert_eve_json"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["suricata_alert_signature_id"] == "2024468"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["source_ip"] == "1.2.3.4"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["suricata_flow_id"] == "1258832998001901"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["suricata_rule_severity"] == "1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["timestamp"] == "2022-07-10T23:50:05.533101Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["datasource_type"] == "file"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Enriched["MarshaledTime"] == "2022-07-10T23:50:05.533101Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Success == true
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-10T23:52:31.097119+0000\",\"flow_id\":836311304881252,\"in_iface\":\"bond0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.5\",\"src_port\":53114,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"metadata\":{\"flowbits\":[\"min.gethttp\",\"http.dottedquadhost\"]},\"community_id\":\"xx\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2843816,\"rev\":1,\"signature\":\"ETPRO HUNTING Generic Inbound URI Directory Traversal\",\"category\":\"Potentially Bad Traffic\",\"severity\":2,\"metadata\":{\"created_at\":[\"2020_08_04\"],\"deployment\":[\"Perimeter\"],\"former_category\":[\"HUNTING\"],\"performance_impact\":[\"Moderate\"],\"signature_severity\":[\"Informational\"],\"updated_at\":[\"2020_08_04\"]},\"rule\":\"alert http any any -> [$HTTP_SERVERS,$HOME_NET] any (msg:\\\"ETPRO HUNTING Generic Inbound URI Directory Traversal\\\"; flow:established,to_server; http.uri; content:\\\"=../\\\"; fast_pattern; classtype:bad-unknown; sid:2843816; rev:1; metadata:created_at 2020_08_04, deployment Perimeter, former_category HUNTING, performance_impact Moderate, signature_severity Informational, updated_at 2020_08_04;)\"},\"app_proto\":\"http\",\"payload_printable\":\"GET /ind.\",\"stream\":1,\"packet\":\"xxx\",\"packet_info\":{\"linktype\":1}}"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["program"] == "suricata-evelogs"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["proto"] == "TCP"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["suricata_alert_signature"] == "ETPRO HUNTING Generic Inbound URI Directory Traversal"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["suricata_alert_signature_rev"] == "1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["time"] == "2022-07-10T23:52:31.097119"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["dest_ip"] == "127.0.0.1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["dest_port"] == "80"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["log_type"] == "suricata_alert"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["source_ip"] == "1.2.3.5"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["sub_log_type"] == "suricata_alert_eve_json"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["suricata_alert_signature_id"] == "2843816"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["suricata_rule_severity"] == "2"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["datasource_type"] == "file"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["service"] == "suricata"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["suricata_flow_id"] == "836311304881252"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["timestamp"] == "2022-07-10T23:52:31.097119Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Enriched["MarshaledTime"] == "2022-07-10T23:52:31.097119Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Success == true
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Parsed["program"] == "suricata-evelogs"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Parsed["proto"] == "TCP"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Parsed["suricata_alert_signature"] == "ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Parsed["suricata_alert_signature_rev"] == "4"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Parsed["time"] == "2022-07-11T06:09:52.602489"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Parsed["dest_ip"] == "127.0.0.1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Parsed["dest_port"] == "80"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-11T06:09:52.602489+0000\",\"flow_id\":1684596746908921,\"in_iface\":\"eth0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.7\",\"src_port\":36288,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2034125,\"rev\":4,\"signature\":\"ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2\",\"category\":\"Attempted Administrator Privilege Gain\",\"severity\":1,\"metadata\":{\"affected_product\":[\"Apache_HTTP_server\"],\"attack_target\":[\"Web_Server\"],\"created_at\":[\"2021_10_05\"],\"cve\":[\"CVE_2021_41773\"],\"deployment\":[\"Internet\",\"Perimeter\"],\"former_category\":[\"EXPLOIT\"],\"performance_impact\":[\"Low\"],\"signature_severity\":[\"Major\"],\"updated_at\":[\"2022_04_18\"]}},\"http\":{\"hostname\":\"34.245.178.108\",\"http_port\":80,\"url\":\"/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh\",\"http_user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\",\"http_content_type\":\"text/html\",\"http_method\":\"POST\",\"protocol\":\"HTTP/1.1\",\"status\":400,\"length\":166,\"http_request_body\":\"QT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"http_response_body\":\"PGh0bWw+DQo8aGVhZD48dGl0bGU+NDAwIEJhZCBSZXF1ZXN0PC90aXRsZT48L2hlYWQ+DQo8Ym9keT4NCjxjZW50ZXI+PGgxPjQwMCBCYWQgUmVxdWVzdDwvaDE+PC9jZW50ZXI+DQo8aHI+PGNlbnRlcj5uZ2lueC8xLjE4LjAgKFVidW50dSk8L2NlbnRlcj4NCjwvYm9keT4NCjwvaHRtbD4NCg==\"},\"files\":[{\"filename\":\"/bin/sh\",\"sid\":[],\"gaps\":false,\"state\":\"CLOSED\",\"stored\":false,\"size\":33,\"tx_id\":0}],\"app_proto\":\"http\",\"flow\":{\"pkts_toserver\":4,\"pkts_toclient\":4,\"bytes_toserver\":623,\"bytes_toclient\":599,\"start\":\"2022-07-11T06:09:52.488697+0000\"},\"payload\":\"UE9TVCAvY2dpLWJpbi8uJTJlLy4lMmUvLiUyZS8uJTJlL2Jpbi9zaCBIVFRQLzEuMQ0KSG9zdDogMzQuMjQ1LjE3OC4xMDg6ODANClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS83OC4wLjM5MDQuMTA4IFNhZmFyaS81MzcuMzYNCkNvbnRlbnQtTGVuZ3RoOiAzMw0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCkFjY2VwdC1FbmNvZGluZzogZ3ppcA0KQ29ubmVjdGlvbjogY2xvc2UNCg0KQT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"stream\":1}"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["suricata_alert_signature_id"] == "2034125"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["suricata_flow_id"] == "1684596746908921"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["timestamp"] == "2022-07-11T06:09:52.602489Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["datasource_type"] == "file"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["log_type"] == "suricata_alert"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["suricata_rule_severity"] == "1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["service"] == "suricata"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["source_ip"] == "1.2.3.7"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Meta["sub_log_type"] == "suricata_alert_eve_json"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][2].Evt.Enriched["MarshaledTime"] == "2022-07-11T06:09:52.602489Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Success == true
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Parsed["dest_ip"] == "127.0.0.1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Parsed["dest_port"] == "80"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Parsed["message"] == "{\"timestamp\":\"2022-07-12T06:09:52.602489-0000\",\"flow_id\":1684596746908921,\"in_iface\":\"eth0\",\"event_type\":\"alert\",\"src_ip\":\"1.2.3.7\",\"src_port\":36288,\"dest_ip\":\"127.0.0.1\",\"dest_port\":80,\"proto\":\"TCP\",\"tx_id\":0,\"alert\":{\"action\":\"allowed\",\"gid\":1,\"signature_id\":2034125,\"rev\":4,\"signature\":\"ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2\",\"category\":\"Attempted Administrator Privilege Gain\",\"severity\":1,\"metadata\":{\"affected_product\":[\"Apache_HTTP_server\"],\"attack_target\":[\"Web_Server\"],\"created_at\":[\"2021_10_05\"],\"cve\":[\"CVE_2021_41773\"],\"deployment\":[\"Internet\",\"Perimeter\"],\"former_category\":[\"EXPLOIT\"],\"performance_impact\":[\"Low\"],\"signature_severity\":[\"Major\"],\"updated_at\":[\"2022_04_18\"]}},\"http\":{\"hostname\":\"34.245.178.108\",\"http_port\":80,\"url\":\"/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh\",\"http_user_agent\":\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\",\"http_content_type\":\"text/html\",\"http_method\":\"POST\",\"protocol\":\"HTTP/1.1\",\"status\":400,\"length\":166,\"http_request_body\":\"QT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"http_response_body\":\"PGh0bWw+DQo8aGVhZD48dGl0bGU+NDAwIEJhZCBSZXF1ZXN0PC90aXRsZT48L2hlYWQ+DQo8Ym9keT4NCjxjZW50ZXI+PGgxPjQwMCBCYWQgUmVxdWVzdDwvaDE+PC9jZW50ZXI+DQo8aHI+PGNlbnRlcj5uZ2lueC8xLjE4LjAgKFVidW50dSk8L2NlbnRlcj4NCjwvYm9keT4NCjwvaHRtbD4NCg==\"},\"files\":[{\"filename\":\"/bin/sh\",\"sid\":[],\"gaps\":false,\"state\":\"CLOSED\",\"stored\":false,\"size\":33,\"tx_id\":0}],\"app_proto\":\"http\",\"flow\":{\"pkts_toserver\":4,\"pkts_toclient\":4,\"bytes_toserver\":623,\"bytes_toclient\":599,\"start\":\"2022-07-12T06:09:52.488697-0000\"},\"payload\":\"UE9TVCAvY2dpLWJpbi8uJTJlLy4lMmUvLiUyZS8uJTJlL2Jpbi9zaCBIVFRQLzEuMQ0KSG9zdDogMzQuMjQ1LjE3OC4xMDg6ODANClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS83OC4wLjM5MDQuMTA4IFNhZmFyaS81MzcuMzYNCkNvbnRlbnQtTGVuZ3RoOiAzMw0KQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCkFjY2VwdC1FbmNvZGluZzogZ3ppcA0KQ29ubmVjdGlvbjogY2xvc2UNCg0KQT18ZWNobztlY2hvIC1uIE1NeW5LekJmY3p8bWQ1c3Vt\",\"stream\":1}"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Parsed["program"] == "suricata-evelogs"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Parsed["proto"] == "TCP"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Parsed["suricata_alert_signature"] == "ET EXPLOIT Apache HTTP Server 2.4.49 - Path Traversal Attempt (CVE-2021-41773) M2"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Parsed["suricata_alert_signature_rev"] == "4"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Parsed["time"] == "2022-07-12T06:09:52.602489"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["datasource_path"] == "suricata-logs-evelog.log"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["log_type"] == "suricata_alert"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["service"] == "suricata"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["sub_log_type"] == "suricata_alert_eve_json"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["suricata_flow_id"] == "1684596746908921"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["datasource_type"] == "file"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["source_ip"] == "1.2.3.7"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["suricata_alert_signature_id"] == "2034125"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["suricata_rule_severity"] == "1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Meta["timestamp"] == "2022-07-12T06:09:52.602489Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][3].Evt.Enriched["MarshaledTime"] == "2022-07-12T06:09:52.602489Z"
len(results["success"][""]) == 0
