len(results) == 4
len(results["s00-raw"]["crowdsecurity/non-syslog"]) == 2
results["s00-raw"]["crowdsecurity/non-syslog"][0].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Parsed["message"] == "{\"eventVersion\":\"1.08\",\"userIdentity\":{\"type\":\"IAMUser\",\"principalId\":\"<principalId>\",\"accountId\":\"<accountId>\",\"accessKeyId\":\"\",\"userName\":\"<userName>\"},\"eventTime\":\"2023-04-11T15:24:00Z\",\"eventSource\":\"signin.amazonaws.com\",\"eventName\":\"ConsoleLogin\",\"awsRegion\":\"us-east-1\",\"sourceIPAddress\":\"1.2.3.4\",\"userAgent\":\"Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101Firefox/102.0\",\"errorMessage\":\"Failed authentication\",\"requestParameters\":null,\"responseElements\":{\"ConsoleLogin\":\"Failure\"},\"additionalEventData\":{\"LoginTo\":\"https://urllogin\",\"MobileVersion\":\"No\",\"MFAUsed\":\"Yes\"},\"eventID\":\"<eventId>\",\"readOnly\":false,\"eventType\":\"AwsConsoleSignIn\",\"managementEvent\":true,\"recipientAccountId\":\"<accoundId>\",\"eventCategory\":\"Management\",\"tlsDetails\":{\"tlsVersion\":\"TLSv1.3\",\"cipherSuite\":\"TLS_AES_128_GCM_SHA256\",\"clientProvidedHostHeader\":\"signin.aws.amazon.com\"}}"
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Parsed["program"] == "aws-cloudtrail"
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Meta["datasource_path"] == "aws-cloudtrail.log"
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Parsed["message"] == "{\"eventVersion\":\"1.08\",\"userIdentity\":{\"type\":\"AssumedRole\",\"principalId\":\"<principalId>\",\"arn\":\"<arn>\",\"accountId\":\"<accountId>\",\"accessKeyId\":\"<accesskeyId>\",\"sessionContext\":{\"sessionIssuer\":{\"type\":\"Role\",\"principalId\":\"<princpalId>\",\"arn\":\"<arn>\",\"accountId\":\"<accountId>\",\"userName\":\"<username>\"},\"webIdFederationData\":{},\"attributes\":{\"creationDate\":\"2023-03-29T14:39:09Z\",\"mfaAuthenticated\":\"true\"}}},\"eventTime\":\"2023-03-29T14:39:10Z\",\"eventSource\":\"sts.amazonaws.com\",\"eventName\":\"GetCallerIdentity\",\"awsRegion\":\"es-east-1\",\"sourceIPAddress\":\"1.2.3.4\",\"userAgent\":\"aws-cli/2.4.11 Python/3.8.8 Linux/5.10.102.1-microsoft-standard-WSL2 exe/x86_64.ubuntu.20 prompt/off command/sts.get-caller-identity\",\"requestParameters\":null,\"responseElements\":null,\"requestID\":\"<request-i>\",\"eventID\":\"<eventid>\",\"readOnly\":true,\"eventType\":\"AwsApiCall\",\"managementEvent\":true,\"recipientAccountId\":\"<accountId>\",\"eventCategory\":\"Management\",\"tlsDetails\":{\"tlsVersion\":\"TLSv1.2\",\"cipherSuite\":\"ECDHE-RSA-AES128-GCM-SHA256\",\"clientProvidedHostHeader\":\"sts.eu-west-1.amazonaws.com\"}}"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Parsed["program"] == "aws-cloudtrail"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Meta["datasource_path"] == "aws-cloudtrail.log"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Meta["datasource_type"] == "file"
len(results["s00-raw"]["crowdsecurity/syslog-logs"]) == 2
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Success == false
results["s00-raw"]["crowdsecurity/syslog-logs"][1].Success == false
len(results["s01-parse"]["crowdsecurity/aws-cloudtrail"]) == 2
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Success == true
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Parsed["message"] == "{\"eventVersion\":\"1.08\",\"userIdentity\":{\"type\":\"IAMUser\",\"principalId\":\"<principalId>\",\"accountId\":\"<accountId>\",\"accessKeyId\":\"\",\"userName\":\"<userName>\"},\"eventTime\":\"2023-04-11T15:24:00Z\",\"eventSource\":\"signin.amazonaws.com\",\"eventName\":\"ConsoleLogin\",\"awsRegion\":\"us-east-1\",\"sourceIPAddress\":\"1.2.3.4\",\"userAgent\":\"Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101Firefox/102.0\",\"errorMessage\":\"Failed authentication\",\"requestParameters\":null,\"responseElements\":{\"ConsoleLogin\":\"Failure\"},\"additionalEventData\":{\"LoginTo\":\"https://urllogin\",\"MobileVersion\":\"No\",\"MFAUsed\":\"Yes\"},\"eventID\":\"<eventId>\",\"readOnly\":false,\"eventType\":\"AwsConsoleSignIn\",\"managementEvent\":true,\"recipientAccountId\":\"<accoundId>\",\"eventCategory\":\"Management\",\"tlsDetails\":{\"tlsVersion\":\"TLSv1.3\",\"cipherSuite\":\"TLS_AES_128_GCM_SHA256\",\"clientProvidedHostHeader\":\"signin.aws.amazon.com\"}}"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Parsed["program"] == "aws-cloudtrail"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["datasource_type"] == "file"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["event_id"] == "<eventId>"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["source_ip"] == "1.2.3.4"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["user_agent"] == "Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101Firefox/102.0"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["datasource_path"] == "aws-cloudtrail.log"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["event_name"] == "ConsoleLogin"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["event_source"] == "signin.amazonaws.com"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["log_type"] == "aws-cloudtrail"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["region"] == "us-east-1"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["user_arn"] == "<userName>"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["user_type"] == "IAMUser"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][0].Evt.Meta["account_id"] == "<accountId>"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Success == true
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Parsed["message"] == "{\"eventVersion\":\"1.08\",\"userIdentity\":{\"type\":\"AssumedRole\",\"principalId\":\"<principalId>\",\"arn\":\"<arn>\",\"accountId\":\"<accountId>\",\"accessKeyId\":\"<accesskeyId>\",\"sessionContext\":{\"sessionIssuer\":{\"type\":\"Role\",\"principalId\":\"<princpalId>\",\"arn\":\"<arn>\",\"accountId\":\"<accountId>\",\"userName\":\"<username>\"},\"webIdFederationData\":{},\"attributes\":{\"creationDate\":\"2023-03-29T14:39:09Z\",\"mfaAuthenticated\":\"true\"}}},\"eventTime\":\"2023-03-29T14:39:10Z\",\"eventSource\":\"sts.amazonaws.com\",\"eventName\":\"GetCallerIdentity\",\"awsRegion\":\"es-east-1\",\"sourceIPAddress\":\"1.2.3.4\",\"userAgent\":\"aws-cli/2.4.11 Python/3.8.8 Linux/5.10.102.1-microsoft-standard-WSL2 exe/x86_64.ubuntu.20 prompt/off command/sts.get-caller-identity\",\"requestParameters\":null,\"responseElements\":null,\"requestID\":\"<request-i>\",\"eventID\":\"<eventid>\",\"readOnly\":true,\"eventType\":\"AwsApiCall\",\"managementEvent\":true,\"recipientAccountId\":\"<accountId>\",\"eventCategory\":\"Management\",\"tlsDetails\":{\"tlsVersion\":\"TLSv1.2\",\"cipherSuite\":\"ECDHE-RSA-AES128-GCM-SHA256\",\"clientProvidedHostHeader\":\"sts.eu-west-1.amazonaws.com\"}}"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Parsed["program"] == "aws-cloudtrail"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["source_ip"] == "1.2.3.4"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["user_agent"] == "aws-cli/2.4.11 Python/3.8.8 Linux/5.10.102.1-microsoft-standard-WSL2 exe/x86_64.ubuntu.20 prompt/off command/sts.get-caller-identity"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["user_type"] == "AssumedRole"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["datasource_path"] == "aws-cloudtrail.log"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["datasource_type"] == "file"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["event_name"] == "GetCallerIdentity"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["event_source"] == "sts.amazonaws.com"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["user_arn"] == "<arn>"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["account_id"] == "<accountId>"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["event_id"] == "<eventid>"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["log_type"] == "aws-cloudtrail"
results["s01-parse"]["crowdsecurity/aws-cloudtrail"][1].Evt.Meta["region"] == "es-east-1"
len(results["s02-enrich"]["crowdsecurity/dateparse-enrich"]) == 2
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Success == true
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["program"] == "aws-cloudtrail"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["message"] == "{\"eventVersion\":\"1.08\",\"userIdentity\":{\"type\":\"IAMUser\",\"principalId\":\"<principalId>\",\"accountId\":\"<accountId>\",\"accessKeyId\":\"\",\"userName\":\"<userName>\"},\"eventTime\":\"2023-04-11T15:24:00Z\",\"eventSource\":\"signin.amazonaws.com\",\"eventName\":\"ConsoleLogin\",\"awsRegion\":\"us-east-1\",\"sourceIPAddress\":\"1.2.3.4\",\"userAgent\":\"Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101Firefox/102.0\",\"errorMessage\":\"Failed authentication\",\"requestParameters\":null,\"responseElements\":{\"ConsoleLogin\":\"Failure\"},\"additionalEventData\":{\"LoginTo\":\"https://urllogin\",\"MobileVersion\":\"No\",\"MFAUsed\":\"Yes\"},\"eventID\":\"<eventId>\",\"readOnly\":false,\"eventType\":\"AwsConsoleSignIn\",\"managementEvent\":true,\"recipientAccountId\":\"<accoundId>\",\"eventCategory\":\"Management\",\"tlsDetails\":{\"tlsVersion\":\"TLSv1.3\",\"cipherSuite\":\"TLS_AES_128_GCM_SHA256\",\"clientProvidedHostHeader\":\"signin.aws.amazon.com\"}}"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["timestamp"] == "2023-04-11T15:24:00Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["user_arn"] == "<userName>"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["datasource_path"] == "aws-cloudtrail.log"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["event_id"] == "<eventId>"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["event_name"] == "ConsoleLogin"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["event_source"] == "signin.amazonaws.com"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["log_type"] == "aws-cloudtrail"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["region"] == "us-east-1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["account_id"] == "<accountId>"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["datasource_type"] == "file"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["source_ip"] == "1.2.3.4"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["user_agent"] == "Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101Firefox/102.0"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["user_type"] == "IAMUser"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Enriched["MarshaledTime"] == "2023-04-11T15:24:00Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Success == true
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["message"] == "{\"eventVersion\":\"1.08\",\"userIdentity\":{\"type\":\"AssumedRole\",\"principalId\":\"<principalId>\",\"arn\":\"<arn>\",\"accountId\":\"<accountId>\",\"accessKeyId\":\"<accesskeyId>\",\"sessionContext\":{\"sessionIssuer\":{\"type\":\"Role\",\"principalId\":\"<princpalId>\",\"arn\":\"<arn>\",\"accountId\":\"<accountId>\",\"userName\":\"<username>\"},\"webIdFederationData\":{},\"attributes\":{\"creationDate\":\"2023-03-29T14:39:09Z\",\"mfaAuthenticated\":\"true\"}}},\"eventTime\":\"2023-03-29T14:39:10Z\",\"eventSource\":\"sts.amazonaws.com\",\"eventName\":\"GetCallerIdentity\",\"awsRegion\":\"es-east-1\",\"sourceIPAddress\":\"1.2.3.4\",\"userAgent\":\"aws-cli/2.4.11 Python/3.8.8 Linux/5.10.102.1-microsoft-standard-WSL2 exe/x86_64.ubuntu.20 prompt/off command/sts.get-caller-identity\",\"requestParameters\":null,\"responseElements\":null,\"requestID\":\"<request-i>\",\"eventID\":\"<eventid>\",\"readOnly\":true,\"eventType\":\"AwsApiCall\",\"managementEvent\":true,\"recipientAccountId\":\"<accountId>\",\"eventCategory\":\"Management\",\"tlsDetails\":{\"tlsVersion\":\"TLSv1.2\",\"cipherSuite\":\"ECDHE-RSA-AES128-GCM-SHA256\",\"clientProvidedHostHeader\":\"sts.eu-west-1.amazonaws.com\"}}"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["program"] == "aws-cloudtrail"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["event_source"] == "sts.amazonaws.com"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["log_type"] == "aws-cloudtrail"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["timestamp"] == "2023-03-29T14:39:10Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["user_agent"] == "aws-cli/2.4.11 Python/3.8.8 Linux/5.10.102.1-microsoft-standard-WSL2 exe/x86_64.ubuntu.20 prompt/off command/sts.get-caller-identity"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["datasource_path"] == "aws-cloudtrail.log"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["datasource_type"] == "file"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["event_name"] == "GetCallerIdentity"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["region"] == "es-east-1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["source_ip"] == "1.2.3.4"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["user_arn"] == "<arn>"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["user_type"] == "AssumedRole"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["account_id"] == "<accountId>"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["event_id"] == "<eventid>"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Enriched["MarshaledTime"] == "2023-03-29T14:39:10Z"
len(results["success"][""]) == 0
