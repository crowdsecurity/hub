len(results) == 4
len(results["s00-raw"]["crowdsecurity/syslog-logs"]) == 1
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Success == true
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Evt.Parsed["logsource"] == "syslog"
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Evt.Parsed["message"] == "srcuser: The value for the SHELL variable was not found the /etc/shells file [USER=root] [TTY=/dev/pts/3] [CWD=/tmp/poc-cve-2021-4034-main] [COMMAND=GCONV_PATH=./gconv PATH=GCONV_PATH=. SHELL=/fake/shell CHARSET=payload]"
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Evt.Parsed["pid"] == "387348"
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Evt.Parsed["program"] == "pkexec"
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Evt.Parsed["timestamp"] == "Jan 27 11:02:49"
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Evt.Meta["datasource_path"] == "CVE-2021-4034.log"
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Evt.Meta["machine"] == "machine"
len(results["s01-parse"]["crowdsecurity/pkexec-logs"]) == 1
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Success == true
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Parsed["message"] == "srcuser: The value for the SHELL variable was not found the /etc/shells file [USER=root] [TTY=/dev/pts/3] [CWD=/tmp/poc-cve-2021-4034-main] [COMMAND=GCONV_PATH=./gconv PATH=GCONV_PATH=. SHELL=/fake/shell CHARSET=payload]"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Parsed["program"] == "pkexec"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Parsed["timestamp"] == "Jan 27 11:02:49"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Parsed["logsource"] == "syslog"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Parsed["pid"] == "387348"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Parsed["user"] == "srcuser"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Meta["machine"] == "machine"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Meta["target_user"] == "srcuser"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Meta["datasource_path"] == "CVE-2021-4034.log"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Meta["datasource_type"] == "file"
results["s01-parse"]["crowdsecurity/pkexec-logs"][0].Evt.Meta["log_type"] == "CVE-2021-4034-xpl"
len(results["s02-enrich"]["crowdsecurity/dateparse-enrich"]) == 1
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Success == true
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["pid"] == "387348"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["timestamp"] == "Jan 27 11:02:49"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["user"] == "srcuser"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["message"] == "srcuser: The value for the SHELL variable was not found the /etc/shells file [USER=root] [TTY=/dev/pts/3] [CWD=/tmp/poc-cve-2021-4034-main] [COMMAND=GCONV_PATH=./gconv PATH=GCONV_PATH=. SHELL=/fake/shell CHARSET=payload]"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["logsource"] == "syslog"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["program"] == "pkexec"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["datasource_path"] == "CVE-2021-4034.log"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["datasource_type"] == "file"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["log_type"] == "CVE-2021-4034-xpl"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["machine"] == "machine"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["target_user"] == "srcuser"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["timestamp"][4:] == "-01-27T11:02:49Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Enriched["MarshaledTime"][4:] == "-01-27T11:02:49Z"
len(results["success"][""]) == 0
