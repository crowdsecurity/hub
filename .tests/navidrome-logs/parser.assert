len(results) == 4
len(results["s00-raw"]["crowdsecurity/non-syslog"]) == 2
results["s00-raw"]["crowdsecurity/non-syslog"][0].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Parsed["message"] == "time=\"2025-01-30T05:07:37Z\" level=warning msg=\"HTTP: POST http://example.com/auth/login\" elapsedTime=\"792.538µs\" httpStatus=401 remoteAddr=192.168.1.1 requestId=navidrome-statefulset-0/YzKDTM4yVE-001467 responseSize=40 userAgent=\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0\""
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Parsed["program"] == "navidrome"
basename(results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Meta["datasource_path"]) == "navidrome-logs.log"
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][0].Evt.Whitelisted == false
results["s00-raw"]["crowdsecurity/non-syslog"][1].Success == true
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Parsed["message"] == "time=\"2025-08-03T15:20:27Z\" level=warning msg=\"HTTP: POST http://navidrome.example.com/nav/auth/login\" elapsedTime=8.5ms httpStatus=401 remoteAddr=\"::1\" requestId=cb472a3fcf9a/49PgJ3c7sx-000076 responseSize=40 userAgent=\"Mozilla/5.0 (Android 12; Mobile; rv:141.0) Gecko/141.0 Firefox/141.0\""
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Parsed["program"] == "navidrome"
basename(results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Meta["datasource_path"]) == "navidrome-logs.log"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Meta["datasource_type"] == "file"
results["s00-raw"]["crowdsecurity/non-syslog"][1].Evt.Whitelisted == false
len(results["s00-raw"]["crowdsecurity/syslog-logs"]) == 2
results["s00-raw"]["crowdsecurity/syslog-logs"][0].Success == false
results["s00-raw"]["crowdsecurity/syslog-logs"][1].Success == false
len(results["s01-parse"]["sdwilsh/navidrome-logs"]) == 2
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Success == true
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Parsed["message"] == "time=\"2025-01-30T05:07:37Z\" level=warning msg=\"HTTP: POST http://example.com/auth/login\" elapsedTime=\"792.538µs\" httpStatus=401 remoteAddr=192.168.1.1 requestId=navidrome-statefulset-0/YzKDTM4yVE-001467 responseSize=40 userAgent=\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0\""
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Parsed["program"] == "navidrome"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Meta["auth_status"] == "failed"
basename(results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Meta["datasource_path"]) == "navidrome-logs.log"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Meta["datasource_type"] == "file"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Meta["http_status"] == "401"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Meta["http_user_agent"] == "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Meta["service"] == "navidrome"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Meta["source_ip"] == "192.168.1.1"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Unmarshaled["navidrome"]["remoteAddr"] == "192.168.1.1"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Unmarshaled["navidrome"]["requestId"] == "navidrome-statefulset-0/YzKDTM4yVE-001467"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Unmarshaled["navidrome"]["responseSize"] == "40"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Unmarshaled["navidrome"]["msg"] == "HTTP: POST http://example.com/auth/login"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Unmarshaled["navidrome"]["time"] == "2025-01-30T05:07:37Z"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Unmarshaled["navidrome"]["userAgent"] == "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Unmarshaled["navidrome"]["elapsedTime"] == "792.538µs"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Unmarshaled["navidrome"]["httpStatus"] == "401"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Unmarshaled["navidrome"]["level"] == "warning"
results["s01-parse"]["sdwilsh/navidrome-logs"][0].Evt.Whitelisted == false
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Success == true
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Parsed["message"] == "time=\"2025-08-03T15:20:27Z\" level=warning msg=\"HTTP: POST http://navidrome.example.com/nav/auth/login\" elapsedTime=8.5ms httpStatus=401 remoteAddr=\"::1\" requestId=cb472a3fcf9a/49PgJ3c7sx-000076 responseSize=40 userAgent=\"Mozilla/5.0 (Android 12; Mobile; rv:141.0) Gecko/141.0 Firefox/141.0\""
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Parsed["program"] == "navidrome"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Meta["auth_status"] == "failed"
basename(results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Meta["datasource_path"]) == "navidrome-logs.log"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Meta["datasource_type"] == "file"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Meta["http_status"] == "401"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Meta["http_user_agent"] == "Mozilla/5.0 (Android 12; Mobile; rv:141.0) Gecko/141.0 Firefox/141.0"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Meta["service"] == "navidrome"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Meta["source_ip"] == "::1"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Unmarshaled["navidrome"]["httpStatus"] == "401"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Unmarshaled["navidrome"]["level"] == "warning"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Unmarshaled["navidrome"]["remoteAddr"] == "::1"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Unmarshaled["navidrome"]["responseSize"] == "40"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Unmarshaled["navidrome"]["elapsedTime"] == "8.5ms"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Unmarshaled["navidrome"]["msg"] == "HTTP: POST http://navidrome.example.com/nav/auth/login"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Unmarshaled["navidrome"]["requestId"] == "cb472a3fcf9a/49PgJ3c7sx-000076"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Unmarshaled["navidrome"]["time"] == "2025-08-03T15:20:27Z"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Unmarshaled["navidrome"]["userAgent"] == "Mozilla/5.0 (Android 12; Mobile; rv:141.0) Gecko/141.0 Firefox/141.0"
results["s01-parse"]["sdwilsh/navidrome-logs"][1].Evt.Whitelisted == false
len(results["s02-enrich"]["crowdsecurity/dateparse-enrich"]) == 2
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Success == true
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["message"] == "time=\"2025-01-30T05:07:37Z\" level=warning msg=\"HTTP: POST http://example.com/auth/login\" elapsedTime=\"792.538µs\" httpStatus=401 remoteAddr=192.168.1.1 requestId=navidrome-statefulset-0/YzKDTM4yVE-001467 responseSize=40 userAgent=\"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0\""
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Parsed["program"] == "navidrome"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["auth_status"] == "failed"
basename(results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["datasource_path"]) == "navidrome-logs.log"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["datasource_type"] == "file"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["http_status"] == "401"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["http_user_agent"] == "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["service"] == "navidrome"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["source_ip"] == "192.168.1.1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Meta["timestamp"] == "2025-01-30T05:07:37Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Enriched["MarshaledTime"] == "2025-01-30T05:07:37Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Unmarshaled["navidrome"]["httpStatus"] == "401"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Unmarshaled["navidrome"]["msg"] == "HTTP: POST http://example.com/auth/login"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Unmarshaled["navidrome"]["remoteAddr"] == "192.168.1.1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Unmarshaled["navidrome"]["responseSize"] == "40"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Unmarshaled["navidrome"]["time"] == "2025-01-30T05:07:37Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Unmarshaled["navidrome"]["userAgent"] == "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Unmarshaled["navidrome"]["elapsedTime"] == "792.538µs"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Unmarshaled["navidrome"]["level"] == "warning"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Unmarshaled["navidrome"]["requestId"] == "navidrome-statefulset-0/YzKDTM4yVE-001467"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][0].Evt.Whitelisted == false
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Success == true
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["message"] == "time=\"2025-08-03T15:20:27Z\" level=warning msg=\"HTTP: POST http://navidrome.example.com/nav/auth/login\" elapsedTime=8.5ms httpStatus=401 remoteAddr=\"::1\" requestId=cb472a3fcf9a/49PgJ3c7sx-000076 responseSize=40 userAgent=\"Mozilla/5.0 (Android 12; Mobile; rv:141.0) Gecko/141.0 Firefox/141.0\""
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Parsed["program"] == "navidrome"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["auth_status"] == "failed"
basename(results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["datasource_path"]) == "navidrome-logs.log"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["datasource_type"] == "file"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["http_status"] == "401"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["http_user_agent"] == "Mozilla/5.0 (Android 12; Mobile; rv:141.0) Gecko/141.0 Firefox/141.0"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["service"] == "navidrome"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["source_ip"] == "::1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Meta["timestamp"] == "2025-08-03T15:20:27Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Enriched["MarshaledTime"] == "2025-08-03T15:20:27Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Unmarshaled["navidrome"]["time"] == "2025-08-03T15:20:27Z"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Unmarshaled["navidrome"]["remoteAddr"] == "::1"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Unmarshaled["navidrome"]["responseSize"] == "40"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Unmarshaled["navidrome"]["userAgent"] == "Mozilla/5.0 (Android 12; Mobile; rv:141.0) Gecko/141.0 Firefox/141.0"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Unmarshaled["navidrome"]["elapsedTime"] == "8.5ms"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Unmarshaled["navidrome"]["httpStatus"] == "401"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Unmarshaled["navidrome"]["level"] == "warning"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Unmarshaled["navidrome"]["msg"] == "HTTP: POST http://navidrome.example.com/nav/auth/login"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Unmarshaled["navidrome"]["requestId"] == "cb472a3fcf9a/49PgJ3c7sx-000076"
results["s02-enrich"]["crowdsecurity/dateparse-enrich"][1].Evt.Whitelisted == false
len(results["success"][""]) == 0
